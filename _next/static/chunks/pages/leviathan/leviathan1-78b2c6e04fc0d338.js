(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[283],{53175:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/leviathan/leviathan1",function(){return n(40887)}])},34655:function(e,t,n){"use strict";var r=n(85893),i=n(40335),o=n.n(i);t.Z=function(e){var t=e.src,n=e.alt,i=e.width,s=void 0===i?600:i;return(0,r.jsx)("div",{className:o().imgContainer,children:(0,r.jsx)("img",{src:"/over-the-wire"+t,alt:n,width:s})})}},87582:function(e,t,n){"use strict";var r=n(85893),i=n(76992),o=n.n(i);t.Z=function(e){var t=e.children;return(0,r.jsxs)("div",{className:o().keyword,children:[(0,r.jsx)("p",{className:o().keywordHead,children:"Keywords: "}),t]})}},69242:function(e,t,n){"use strict";var r=n(85893),i=n(41664),o=n(98574),s=n.n(o);t.Z=function(e){var t=e.link1,n=e.link2;return(0,r.jsxs)("div",{className:s().pageNav,children:[(0,r.jsx)("div",{children:t?(0,r.jsx)(i.default,{href:t,children:(0,r.jsx)("a",{title:"Previous page",className:s().navButton,children:"\u25c0"})}):""}),(0,r.jsx)("div",{children:n?(0,r.jsx)(i.default,{href:n,children:(0,r.jsx)("a",{title:"Next page",className:s().navButton,children:"\u25b6"})}):""})]})}},20586:function(e,t,n){"use strict";var r=n(85893),i=n(86655),o=n.n(i),s=n(5227),a=n(84283),l=n(67294);t.Z=function(e){var t=e.children,n=(0,l.useState)(!1),i=n[0],c=n[1];return(0,r.jsxs)("section",{children:[(0,r.jsx)("h2",{children:"Key"}),(0,r.jsxs)("div",{className:o().codeBlock,children:[(0,r.jsx)("div",{className:o().spoilerToggler,children:(0,r.jsx)("button",{onClick:function(){return c(!i)},children:"Click to Reveal"})}),(0,r.jsx)("div",{className:o().spoilerContainer,children:(0,r.jsx)("div",{className:"".concat(o().spoiler," ").concat(i?o().show:""),children:(0,r.jsx)(s.Z,{language:"",style:a.cL,customStyle:{margin:0},children:t})})})]})]})}},35934:function(e,t,n){"use strict";var r=n(85893),i=n(96979),o=n.n(i);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}t.Z=function(e){var t=e.children,n=a(e,["children"]);return(0,r.jsx)("span",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){s(e,t,n[t])}))}return e}({className:o().tag},n,{children:t}))}},40887:function(e,t,n){"use strict";n.r(t);var r=n(85893),i=n(34655),o=n(87582),s=n(69242),a=n(20586),l=n(35934);t.default=function(){return(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{children:"Leviathan 1"}),(0,r.jsx)(o.Z,{children:(0,r.jsx)(l.Z,{children:"ltrace"})}),(0,r.jsxs)("section",{children:[(0,r.jsx)("h2",{children:"Experience"}),(0,r.jsx)("p",{children:"So, here we were greeted with an executable called 'check'. A good first step, I ran the executable at which point it then prompted me for a password. So, somehow, we are supposed to find this password it is comparing to."}),(0,r.jsxs)("p",{children:["I tried looking at the data part of the program using"," ",(0,r.jsx)("code",{children:"objdump -s -j .rodata ./check"}),". This didn't show anything beside the error prompt. I tried using GDB and analysing the comparison steps, putting a breakpoint at a call to strcmp and seeing the register informations, but I wasn't able to find the string it is comparing to."]}),(0,r.jsxs)("p",{children:["After a good amount of time on looking at the assembly code, I researched other methods, I discovered that we can use ",(0,r.jsx)("code",{children:"ltrace"})," to basically see what library and system calls were made before the program exits."]}),(0,r.jsx)(i.Z,{src:"/images/leviathan1-1.png",alt:"ltrace was used to show what arguments are given to strcmp"}),(0,r.jsxs)("p",{children:['As seen, the correct password is "sex". Using that password for the prompt, it appears to run a shell. So I tried using it to access ',(0,r.jsx)("code",{children:"/etc/leviathan_pass/leviathan2"}),". I simply used ",(0,r.jsx)("code",{children:"cat"})," with that path, and I received the password for the next level."]})]}),(0,r.jsxs)("section",{children:[(0,r.jsx)("h2",{children:"Reflection"}),(0,r.jsx)("p",{children:"Reflecting on the time I took to complete this level, I feel that it might have been better to just search for answers. I spent way too much time trying to understand the assembly, when in reality, the level uses something that I didn't know about. Spending time trying things out was great, but it prevents me from doing more levels and hence learn more in the long term."}),(0,r.jsx)("p",{children:"In terms of security, it's really about learning the many tools available to reverse engineer a program even when it is in compiled form. It may be difficult to do using gdb and objdump, so I was fooled into thinking that while possible it is very difficult, but there are many other programs built to analysed these codes. So, we should keep that in mind while writing programs. Stored company secret in a program for example could be found by doing such reverse engineering hence it might not be a good idea. For example, writing credentials inside a user program."})]}),(0,r.jsx)(a.Z,{children:"ougahZi8Ta"}),(0,r.jsx)(s.Z,{link1:"/leviathan/leviathan0",link2:"/leviathan/leviathan2"})]})}},40335:function(e){e.exports={imgContainer:"BlogImage_imgContainer__s2tL6"}},76992:function(e){e.exports={keywordHead:"Keyword_keywordHead__40fuD",keyword:"Keyword_keyword__javqt"}},98574:function(e){e.exports={pageNav:"PageNav_pageNav__NXqbT",navButton:"PageNav_navButton__yHhmO"}},86655:function(e){e.exports={codeBlock:"SpoilerKey_codeBlock__KWl0d",spoilerToggler:"SpoilerKey_spoilerToggler__HCeWZ",spoiler:"SpoilerKey_spoiler__YWx_s",show:"SpoilerKey_show__VIJ75",spoilerContainer:"SpoilerKey_spoilerContainer__O76It"}},96979:function(e){e.exports={tag:"Tag_tag__AJnTY"}}},function(e){e.O(0,[369,774,888,179],(function(){return t=53175,e(e.s=t);var t}));var t=e.O();_N_E=t}]);