(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[543],{29318:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/narnia/narnia0",function(){return t(16927)}])},90654:function(e,n,t){"use strict";var i=t(85893),r=t(23457),s=t.n(r),a=t(5227),o=t(84283);n.Z=function(e){var n=e.children,t=e.language;return(0,i.jsx)("div",{className:s().CodeBlock,children:(0,i.jsx)(a.Z,{language:t,style:o.cL,children:n})})}},87582:function(e,n,t){"use strict";var i=t(85893),r=t(76992),s=t.n(r);n.Z=function(e){var n=e.children;return(0,i.jsxs)("div",{className:s().keyword,children:[(0,i.jsx)("p",{className:s().keywordHead,children:"Keywords: "}),n]})}},69242:function(e,n,t){"use strict";var i=t(85893),r=t(41664),s=t(98574),a=t.n(s);n.Z=function(e){var n=e.link1,t=e.link2;return(0,i.jsxs)("div",{className:a().pageNav,children:[(0,i.jsx)("div",{children:n?(0,i.jsx)(r.default,{href:n,children:(0,i.jsx)("a",{title:"Previous page",className:a().navButton,children:"\u25c0"})}):""}),(0,i.jsx)("div",{children:t?(0,i.jsx)(r.default,{href:t,children:(0,i.jsx)("a",{title:"Next page",className:a().navButton,children:"\u25b6"})}):""})]})}},20586:function(e,n,t){"use strict";var i=t(85893),r=t(86655),s=t.n(r),a=t(5227),o=t(84283),l=t(67294);n.Z=function(e){var n=e.children,t=(0,l.useState)(!1),r=t[0],c=t[1];return(0,i.jsxs)("section",{children:[(0,i.jsx)("h2",{children:"Key"}),(0,i.jsxs)("div",{className:s().codeBlock,children:[(0,i.jsx)("div",{className:s().spoilerToggler,children:(0,i.jsx)("button",{onClick:function(){return c(!r)},children:"Click to Reveal"})}),(0,i.jsx)("div",{className:s().spoilerContainer,children:(0,i.jsx)("div",{className:"".concat(s().spoiler," ").concat(r?s().show:""),children:(0,i.jsx)(a.Z,{language:"",style:o.cL,customStyle:{margin:0},children:n})})})]})]})}},35934:function(e,n,t){"use strict";var i=t(85893),r=t(96979),s=t.n(r);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){if(null==e)return{};var t,i,r=function(e,n){if(null==e)return{};var t,i,r={},s=Object.keys(e);for(i=0;i<s.length;i++)t=s[i],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)t=s[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}n.Z=function(e){var n=e.children,t=o(e,["children"]);return(0,i.jsx)("span",function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},i=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),i.forEach((function(n){a(e,n,t[n])}))}return e}({className:s().tag},t,{children:n}))}},16927:function(e,n,t){"use strict";t.r(n);var i=t(85893),r=t(90654),s=t(87582),a=t(69242),o=t(20586),l=t(35934);n.default=function(){return(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{children:"Narnia 0"}),(0,i.jsx)(s.Z,{children:(0,i.jsx)(l.Z,{children:"buffer-overflow"})}),(0,i.jsxs)("section",{children:[(0,i.jsx)("h2",{children:"Experience"}),(0,i.jsx)("p",{children:"For Narnia, the source code is given to us."}),(0,i.jsx)(r.Z,{language:"c",children:'int main(){\n    long val=0x41414141;\n    char buf[20];\n\n    printf("Correct val\'s value from 0x41414141 -> 0xdeadbeef!\\n");\n    printf("Here is your chance: ");\n    scanf("%24s",&buf);\n    printf("buf: %s\\n",buf);\n    printf("val: 0x%08x\\n",val);\n\n    if(val==0xdeadbeef){\n      setreuid(geteuid(),geteuid());\n      system("/bin/sh");\n    }\n    else {\n      printf("WAY OFF!!!!\\n");\n      exit(1);\n    }\n\n    return 0;\n    '}),(0,i.jsxs)("p",{children:["Before starting, the files does not appear to be there, change directory to ",(0,i.jsx)("code",{children:"/narnia"})," before starting. We are given the source code for this level. We are given hints for this level in the strings of the ",(0,i.jsx)("code",{children:"printf"}),". The goal is to change the value of ",(0,i.jsx)("code",{children:"val"})," to ",(0,i.jsx)("code",{children:"0xdeadbeef"}),". Clearly, this would require some form of buffer overflow. Analysing the code, we can tell that this is possible since the size of the scanf maximum input length is 24 meanwhile the buffer itself is only 20 bytes in size."]}),(0,i.jsx)("p",{children:"This was simple enough, testing with the following code indicate that it seems to work."}),(0,i.jsx)(r.Z,{language:"shell",children:'python -c \'print("a"*20 + "b"*4)\' | ./narnia0'}),(0,i.jsxs)("p",{children:["Next, we must convert change the value so that it matches ",(0,i.jsx)("code",{children:"0xdeadbeef"}),". To do so, we must convert it to a little endian format, this involves putting the smallest byte first, like so: ",(0,i.jsx)("code",{children:"ef eb ad de"}),". Put together, the command we could use is as follows."]}),(0,i.jsx)(r.Z,{language:"shell",children:'python -c \'print("a"*20 +"\\xef\\xbe\\xad\\xde")\' | ./narnia0'}),(0,i.jsxs)("p",{children:["Here was where it got confusing, this successfuly changed the value of ",(0,i.jsx)("code",{children:"val"}),", however, the program simply runs ",(0,i.jsx)("code",{children:"setreuid"})," and ",(0,i.jsx)("code",{children:"system"})," then simply closes. The main problem is that the program runs ",(0,i.jsx)("code",{children:"system"})," which calls a",(0,i.jsx)("code",{children:"/bin/sh"})," which is the shell, then nothing occured and it simply closes. After being stuck for quite a long time, I found that, we may use the ",(0,i.jsx)("code",{children:"cat"})," command in conjunction."]}),(0,i.jsx)(r.Z,{language:"shell",children:'(python -c \'print("a"*20 +"\\xef\\xbe\\xad\\xde")\'; cat) | ./narnia0'}),(0,i.jsxs)("p",{children:["Unlike how I had normally used ",(0,i.jsx)("code",{children:"cat"}),", without any arguments,",(0,i.jsx)("code",{children:"cat"})," simply copies standard input to standard output. Now using the pipe, the cat will send the standard input to the shell running instead, allowing us to use the shell inside the program. I simply used ",(0,i.jsx)("code",{children:"cat /etc/narnia_pass/narnia1"})," ","to then obtain the password for Narnia 1."]})]}),(0,i.jsxs)("section",{children:[(0,i.jsx)("h2",{children:"Reflection"}),(0,i.jsxs)("p",{children:["This was an interesting level to have completed. I have not use ",(0,i.jsx)("code",{children:"cat"}),"in that manner previously and it took quite a while to come to that conclusion. Perhaps, it would have been better to search for hints. But this definitely showcased the difference in difficulty of this wargames to the ones before. An interesting idea that came to mind was how this may relate to the mentions of creating a remote shell seen during the Natas wargames. Perhaps this could be used to create such remote shell, at least as a method of taking inputs in."]}),(0,i.jsxs)("p",{children:["In terms of security, this demonstrated the common vulnerability of a buffer overflow. Since, the memory allocated for the array was only 20 bytes long, by writing extra bytes, it overwrites the ones stored previously, namely the",(0,i.jsx)("code",{children:"val"})," variable in this instance. This is a common type of vulnerability especially when taking in user input we must always allocate enough space or prevent overwriting other data. Standard libraries already allow such feature, in this case however, the vulnerability exist because of the mistmatch of the",(0,i.jsx)("code",{children:"scanf"})," command's specified limit and the length of buffer used. So this is something to look out for, especially when using lower level programming."]})]}),(0,i.jsx)(o.Z,{children:"efeidiedae"}),(0,i.jsx)(a.Z,{link1:"/narnia/",link2:"/narnia/narnia1"})]})}},23457:function(e){e.exports={CodeBlock:"CodeBlock_CodeBlock___IBBd"}},76992:function(e){e.exports={keywordHead:"Keyword_keywordHead__40fuD",keyword:"Keyword_keyword__javqt"}},98574:function(e){e.exports={pageNav:"PageNav_pageNav__NXqbT",navButton:"PageNav_navButton__yHhmO"}},86655:function(e){e.exports={codeBlock:"SpoilerKey_codeBlock__KWl0d",spoilerToggler:"SpoilerKey_spoilerToggler__HCeWZ",spoiler:"SpoilerKey_spoiler__YWx_s",show:"SpoilerKey_show__VIJ75",spoilerContainer:"SpoilerKey_spoilerContainer__O76It"}},96979:function(e){e.exports={tag:"Tag_tag__AJnTY"}}},function(e){e.O(0,[369,774,888,179],(function(){return n=29318,e(e.s=n);var n}));var n=e.O();_N_E=n}]);