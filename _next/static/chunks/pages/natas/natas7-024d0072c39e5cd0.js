(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[908],{9577:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/natas/natas7",function(){return n(3479)}])},654:function(e,t,n){"use strict";var i=n(5893),s=n(3457),r=n.n(s),a=n(5227),o=n(4283);t.Z=function(e){var t=e.children,n=e.language;return(0,i.jsx)("div",{className:r().CodeBlock,children:(0,i.jsx)(a.Z,{language:n,style:o.cL,children:t})})}},7582:function(e,t,n){"use strict";var i=n(5893),s=n(6992),r=n.n(s);t.Z=function(e){var t=e.children;return(0,i.jsxs)("div",{className:r().keyword,children:[(0,i.jsx)("p",{className:r().keywordHead,children:"Keywords: "}),t]})}},9242:function(e,t,n){"use strict";var i=n(5893),s=n(1664),r=n(8574),a=n.n(r);t.Z=function(e){var t=e.link1,n=e.link2;return(0,i.jsxs)("div",{className:a().pageNav,children:[(0,i.jsx)("div",{children:t?(0,i.jsx)(s.default,{href:t,children:(0,i.jsx)("a",{title:"Previous page",className:a().navButton,children:"\u25c0"})}):""}),(0,i.jsx)("div",{children:n?(0,i.jsx)(s.default,{href:n,children:(0,i.jsx)("a",{title:"Next page",className:a().navButton,children:"\u25b6"})}):""})]})}},586:function(e,t,n){"use strict";var i=n(5893),s=n(6655),r=n.n(s),a=n(5227),o=n(4283),l=n(7294);t.Z=function(e){var t=e.children,n=(0,l.useState)(!1),s=n[0],c=n[1];return(0,i.jsxs)("section",{children:[(0,i.jsx)("h2",{children:"Key"}),(0,i.jsxs)("div",{className:r().codeBlock,children:[(0,i.jsx)("div",{className:r().spoilerToggler,children:(0,i.jsx)("button",{onClick:function(){return c(!s)},children:"Click to Reveal"})}),(0,i.jsx)("div",{className:r().spoilerContainer,children:(0,i.jsx)("div",{className:"".concat(r().spoiler," ").concat(s?r().show:""),children:(0,i.jsx)(a.Z,{language:"",style:o.cL,customStyle:{margin:0},children:t})})})]})]})}},5934:function(e,t,n){"use strict";var i=n(5893),s=n(1268),r=n.n(s);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(null==e)return{};var n,i,s=function(e,t){if(null==e)return{};var n,i,s={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}t.Z=function(e){var t=e.children,n=o(e,["children"]);return(0,i.jsx)("span",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){a(e,t,n[t])}))}return e}({className:r().tag},n,{children:t}))}},3479:function(e,t,n){"use strict";n.r(t);var i=n(5893),s=n(654),r=n(7582),a=n(9242),o=n(586),l=n(5934);t.default=function(){return(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{children:"Natas 7"}),(0,i.jsxs)(r.Z,{children:[(0,i.jsx)(l.Z,{children:"php"}),(0,i.jsx)(l.Z,{children:"local-file-inclusion"}),(0,i.jsx)(l.Z,{children:"remote-file-inclusion"})]}),(0,i.jsxs)("section",{children:[(0,i.jsx)("h2",{children:"Experience"}),(0,i.jsxs)("p",{children:['In this level, we are greeted with two links, one labeled "Home" and one labeled "About". When the links are linked it changes the url but not as we have previously seen. For example, when the About link is clicked, it appends'," ",(0,i.jsx)("code",{children:"index.php?page=home"}),". This appears to reference a php file followed by a query of ",(0,i.jsx)("code",{children:"page=home"}),"."]}),(0,i.jsx)("p",{children:"Based on previous limited encounters with php, it seem that php is used to change the content of the document based on the query and all we had to do was to find the right query. Inspecting the page, I noticed the following comment."}),(0,i.jsx)(s.Z,{language:"",children:"\x3c!-- hint: password for webuser natas8 is in /etc/natas_webpass/natas8 --\x3e"}),(0,i.jsx)("p",{children:"I put that path as my query, and the website loaded the password for the next level."})]}),(0,i.jsxs)("section",{children:[(0,i.jsx)("h2",{children:"Research"}),(0,i.jsxs)("p",{children:["What is php and what role does it play in website servers? The ",(0,i.jsx)("a",{href:"https://en.wikipedia.org/wiki/PHP",children:"Wikipedia entry"})," for php states that it is a",(0,i.jsx)("q",{children:"general-purpose scripting language geared towards web development."}),"So, in other words, in this case, it seems to just be a scripting language used in the server to change the html elements served to the users. Php scripts may look like a typical html file with a php script written using a special angular bracket notation with a question mark."]}),(0,i.jsxs)("p",{children:["I noticed that the difference between using a general purpose script and simply using a typical website directory system, is that it might be possible to access files which we are not supposed to. A ",(0,i.jsx)("a",{href:"https://brightsec.com/blog/file-inclusion-vulnerabilities/",children:"blog from Bright.com"})," ","discusses about something called the ",(0,i.jsx)("em",{children:"File Inclusion Vulnerability"}),". File inclusion vulnerability occurs when user inputs are not properly validated and inserted into a file inclusion command in a scripting language. There are two potential types of file inclusion attack,",(0,i.jsx)("em",{children:"Local File Inclusion"})," (LFI) and ",(0,i.jsx)("em",{children:"Remote File Inclusion"}),"(RFI)"]}),(0,i.jsx)("p",{children:"LFI pertains to using local files in the server, allowing access to them or even execution. RFI on the other hand involves letting the server download a remote file and executing it. These are both dangerous and may lead to remote code execution and hence letting attackers create web shells. Prevention are similar to how we may prevent other mixing-input-in-control-sequence attacks, that is sanitising the input and validating it. Ensure that the program has limited access as well, don't use unneeded permissions when running it."}),(0,i.jsxs)("p",{children:[(0,i.jsx)("a",{href:"https://en.wikipedia.org/wiki/File_inclusion_vulnerability",children:"Wikipedia"})," has an entry on file inclusion vulnerability which includes example vulnerable code."]})]}),(0,i.jsxs)("section",{children:[(0,i.jsx)("h2",{children:"Reflection"}),(0,i.jsx)("p",{children:"I reflected on what I've learnt from this exercise. I guess, I learnt a little bit about php, but during my reflection, i questioned whether this was another reminder that attackers could simply guess urls. This doesn't seem to be the main concern. I then asked myself how this is any different from appending the url with the path itself? Well, I realised that the difference is that a general-purpose script was being run and it might be possible to access files from the server which users are not supposed to have access to. That was how I ended up reseaching about the file inclusion vulnerability."}),(0,i.jsx)("p",{children:"So I thought this was a good introduction to server side security. By using a system that can read files from the server, it exposes much more to attackers. This is especially important to remember as web applications are becoming ever more popular, that while they allow for more functionalities, it is also exposed to more dangerous attacks."})]}),(0,i.jsx)(o.Z,{children:"DBfUBfqQG69KvJvJ1iAbMoIpwSNQ9bWe"}),(0,i.jsx)(a.Z,{link1:"/natas/natas6",link2:"/natas/natas8"})]})}},3457:function(e){e.exports={CodeBlock:"CodeBlock_CodeBlock___IBBd"}},6992:function(e){e.exports={keywordHead:"Keyword_keywordHead__40fuD",keyword:"Keyword_keyword__javqt"}},8574:function(e){e.exports={pageNav:"PageNav_pageNav__NXqbT",navButton:"PageNav_navButton__yHhmO"}},6655:function(e){e.exports={codeBlock:"SpoilerKey_codeBlock__KWl0d",spoilerToggler:"SpoilerKey_spoilerToggler__HCeWZ",spoiler:"SpoilerKey_spoiler__YWx_s",show:"SpoilerKey_show__VIJ75",spoilerContainer:"SpoilerKey_spoilerContainer__O76It"}},1268:function(e){e.exports={tag:"Tag_tag__AJnTY"}}},function(e){e.O(0,[369,774,888,179],(function(){return t=9577,e(e.s=t);var t}));var t=e.O();_N_E=t}]);