(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[908],{9577:function(e,i,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/natas/natas7",function(){return n(3479)}])},9242:function(e,i,n){"use strict";var t=n(5893),s=n(1664),a=n(8574),r=n.n(a);i.Z=function(e){var i=e.link1,n=e.link2;return(0,t.jsxs)("div",{className:r().pageNav,children:[(0,t.jsx)("div",{children:i?(0,t.jsx)(s.default,{href:i,children:(0,t.jsx)("a",{title:"Previous page",className:r().navButton,children:"\u25c0"})}):""}),(0,t.jsx)("div",{children:n?(0,t.jsx)(s.default,{href:n,children:(0,t.jsx)("a",{title:"Next page",className:r().navButton,children:"\u25b6"})}):""})]})}},586:function(e,i,n){"use strict";var t=n(5893),s=n(6655),a=n.n(s),r=n(5227),l=n(4283),o=n(7294);i.Z=function(e){var i=e.children,n=(0,o.useState)(!1),s=n[0],h=n[1];return(0,t.jsxs)("section",{children:[(0,t.jsx)("h2",{children:"Key"}),(0,t.jsxs)("div",{className:a().codeBlock,children:[(0,t.jsx)("div",{className:a().spoilerToggler,children:(0,t.jsx)("button",{onClick:function(){return h(!s)},children:"Click to Reveal"})}),(0,t.jsx)("div",{className:a().spoilerContainer,children:(0,t.jsx)("div",{className:"".concat(a().spoiler," ").concat(s?a().show:""),children:(0,t.jsx)(r.Z,{language:"",style:l.cL,customStyle:{margin:0},children:i})})})]})]})}},3479:function(e,i,n){"use strict";n.r(i);var t=n(5893),s=n(9242),a=n(586);i.default=function(){return(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{children:"Natas 7"}),(0,t.jsxs)("p",{children:['In this level, we are greeted with two links, one labeled "Home" and one labeled "About". When the links are linked it changes the url but not as we have previously seen. For example, when the About link is clicked, it appends'," ",(0,t.jsx)("code",{children:"index.php?page=home"}),". This appears to reference a php file followed by a query of ",(0,t.jsx)("code",{children:"page=home"}),"."]}),(0,t.jsxs)("p",{children:["What is php and what role does it play in website servers? The wikipedia entry for php states that it is a",(0,t.jsx)("q",{children:"general-purpose scripting language geared towards web development."}),"So, in other words, it is just a scripting language which is used in the server. After researching the basic syntax of php however, I discovered that one can basically write the html file in a php file. The php script itself is written between the typical html tags using a special angular bracket notation with a question mark. With this knowledge the url makes more sense, it is indeed accessing a php file, and that php file has the html document and I deduce, this php changes the content of the document based on the query. Now the main problem is to find the correct query."]}),(0,t.jsx)("p",{children:"If the page is inspected, there is actually a comment giving us a hint as to where the password may be. The hint reads:"}),(0,t.jsx)("pre",{children:(0,t.jsx)("code",{children:"\x3c!-- hint: password for webuser natas8 is in /etc/natas_webpass/natas8 --\x3e"})}),(0,t.jsx)("p",{children:"Inputting this path to the query, gave the key for natas8."}),(0,t.jsxs)("p",{children:["I reflected on what I've learnt from this exercise. I guess, I learnt a little bit about php, but how is this different from appending the url with the path itself? Well, I realised that the difference is that a general-purpose script was being run, so I searched up, whether this make it possible for me to access any files from the server remotely. A ",(0,t.jsx)("a",{href:"https://brightsec.com/blog/file-inclusion-vulnerabilities/",children:"blog from Bright.com"})," ","discusses about something called the ",(0,t.jsx)("em",{children:"File Inclusion Vulnerability"}),". File inclusion vulnerability occurs when user inputs are not properly validated and inserted into a file inclusion command in a scripting language. There are two potential types of file inclusion attack,",(0,t.jsx)("em",{children:"Local File Inclusion"})," (LFI) and ",(0,t.jsx)("em",{children:"Remote File Inclusion"}),"(RFI)"]}),(0,t.jsx)("p",{children:"LFI pertains to using local files in the server, allowing access to them or even execution. RFI on the other hand involves letting the server download a remote file and executing it. These are both dangerous and may lead to remote code execution and hence letting attackers create web shells. Prevention are similar to how we may prevent other mixing-input-in-control-sequence attacks, that is sanitising the input and validating it. Ensure that the program has limited access as well, don't use unneeded permissions when running it."}),(0,t.jsxs)("p",{children:[(0,t.jsx)("a",{href:"https://en.wikipedia.org/wiki/File_inclusion_vulnerability",children:"Wikipedia"})," has an entry on file inclusion vulnerability which includes example vulnerable code."]}),(0,t.jsx)(a.Z,{children:"DBfUBfqQG69KvJvJ1iAbMoIpwSNQ9bWe"}),(0,t.jsx)(s.Z,{link1:"natas6",link2:"natas8"})]})}},8574:function(e){e.exports={pageNav:"PageNav_pageNav__NXqbT",navButton:"PageNav_navButton__yHhmO"}},6655:function(e){e.exports={codeBlock:"SpoilerKey_codeBlock__KWl0d",spoilerToggler:"SpoilerKey_spoilerToggler__HCeWZ",spoiler:"SpoilerKey_spoiler__YWx_s",show:"SpoilerKey_show__VIJ75",spoilerContainer:"SpoilerKey_spoilerContainer__O76It"}}},function(e){e.O(0,[369,774,888,179],(function(){return i=9577,e(e.s=i);var i}));var i=e.O();_N_E=i}]);