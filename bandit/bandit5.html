<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/over-the-wire/_next/static/css/86b7aba7af294b94.css" as="style"/><link rel="stylesheet" href="/over-the-wire/_next/static/css/86b7aba7af294b94.css" data-n-g=""/><link rel="preload" href="/over-the-wire/_next/static/css/21a6889b2154d675.css" as="style"/><link rel="stylesheet" href="/over-the-wire/_next/static/css/21a6889b2154d675.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/over-the-wire/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/over-the-wire/_next/static/chunks/webpack-f6318ba5529f7f5c.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/framework-81da43a8dcd978d9.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/main-00ca3f3974f0a67a.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/pages/_app-4def5050ef33c1d2.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/369-eeb2b79f75cc27b6.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/pages/bandit/bandit5-693b23aefa586f22.js" defer=""></script><script src="/over-the-wire/_next/static/SOQwiubIJO28XjsLFBlt8/_buildManifest.js" defer=""></script><script src="/over-the-wire/_next/static/SOQwiubIJO28XjsLFBlt8/_ssgManifest.js" defer=""></script><script src="/over-the-wire/_next/static/SOQwiubIJO28XjsLFBlt8/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><nav class="Nav_navBar__ioQlk"><ul class="Nav_navItems__n_3aD"><li class="Nav_navLink__4k_2G"><a href="/over-the-wire">Home</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/bandit">Bandit</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/natas">Natas</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/leviathan">Leviathan</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/narnia">Narnia</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/cipher">Cipher</a></li></ul></nav><div class="MainContainer_mainContainer__0FIFy"><div><h1>Bandit 5</h1><section><h2>Experience</h2><p>Seems familiar to Bandit 4, this time, we are instructed to find a file that is human-readable, 1033 bytes in size and not an executable. I could try something similar to how I solved Bandit 4, however, it doesn&#x27;t specifically give files which meet the criteria. I didn&#x27;t know where to go for this level. However, looking at the overthewire website, we are told about commands that may be useful, the one that seem most relevant was <!-- --><code>find</code>.<!-- --></p><p>Using just <!-- --><code>find</code>, it returns all the files on the directories. Reading further about the function, there are several flags that can be useful. To select a 1033 byte file, we could use <!-- --><code>-size 1033c</code>. To select non-executable, we could use<!-- --><code>! -executable</code>. The last criteria of being human readable was a bit less clear. One possible way I found was to use the <!-- --><code>-exec</code> flag which allows find to run other commands.<!-- --></p><div class="CodeBlock_CodeBlock___IBBd"><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code class="language-shell" style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#f1fa8c">find<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">!<!-- --></span><span> -executable -size 1033c -exec <!-- --></span><span class="token" style="color:#f1fa8c">file<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">{<!-- --></span><span class="token" style="color:#f8f8f2">}<!-- --></span><span> <!-- --></span><span class="token" style="color:#50fa7b">&#x27;;&#x27;<!-- --></span></code></pre></div><p></p><p>Learnt about using the find command and found a <!-- --><a href="https://unix.stackexchange.com/questions/389705/understanding-the-exec-option-of-find">useful explanation</a> about the <!-- --><code>-exec</code> flag. Using it like in the code above will find all files that are not executable and have a size of 1033 bytes then list what type of file they are. This could further be modified by adding <!-- --><code>grep</code> to get all the files which are of a specific type, like so:<!-- --></p><div class="CodeBlock_CodeBlock___IBBd"><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code class="language-shell" style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#f1fa8c">find<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">!<!-- --></span><span> -executable -size 1033c -exec <!-- --></span><span class="token" style="color:#f1fa8c">file<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">{<!-- --></span><span class="token" style="color:#f8f8f2">}<!-- --></span><span> <!-- --></span><span class="token" style="color:#50fa7b">&#x27;;&#x27;<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">|<!-- --></span><span> <!-- --></span><span class="token" style="color:#f1fa8c">grep<!-- --></span><span> ASCII<!-- --></span></code></pre></div></section><section><h2>Reflection</h2><p>This was actually a really nice learning experience, though it was not overly challenging, it really highlighted the point of doing all these to explore what tools exist.</p><p>In terms of security again, this could be a potential method of exploring target&#x27;s files, what directories exist. More interestingly, we could see that this is a potential method of exploiting file searching. Say that a web server searchest through a directory using the <!-- --><code>find</code> command. Then, we could perform other shell commands using the <!-- --><code>-exec</code> flag. This also showcased how blacklisting might not be a viable solution. For example, a person could prevent users from inputting other commands by blacklisting semicolons. Well, the <!-- --><code>-exec</code> flag would actually not need semicolons. The one above does use it, but you could also use a plus instead. So there are many many ways of doing the same things and as a defender, you might not always think about all those potential ways.<!-- --></p></section><section><h2>Key</h2><div class="SpoilerKey_codeBlock__KWl0d"><div class="SpoilerKey_spoilerToggler__HCeWZ"><button>Click to Reveal</button></div><div class="SpoilerKey_spoilerContainer__O76It"><div class="SpoilerKey_spoiler__YWx_s "><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto;border-radius:0.3em"><code style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>DXjZPULLxYr17uwoI01bNLQbtFemEgo7<!-- --></span></code></pre></div></div></div></section><div class="PageNav_pageNav__NXqbT"><div><a title="Previous page" class="PageNav_navButton__yHhmO" href="/over-the-wire/bandit/bandit4">◀</a></div><div><a title="Next page" class="PageNav_navButton__yHhmO" href="/over-the-wire/natas">▶</a></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/bandit/bandit5","query":{},"buildId":"SOQwiubIJO28XjsLFBlt8","assetPrefix":"/over-the-wire","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>