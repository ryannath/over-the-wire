<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/over-the-wire/_next/static/css/86b7aba7af294b94.css" as="style"/><link rel="stylesheet" href="/over-the-wire/_next/static/css/86b7aba7af294b94.css" data-n-g=""/><link rel="preload" href="/over-the-wire/_next/static/css/fd7ddeb4cf1e4c12.css" as="style"/><link rel="stylesheet" href="/over-the-wire/_next/static/css/fd7ddeb4cf1e4c12.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/over-the-wire/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/over-the-wire/_next/static/chunks/webpack-f6318ba5529f7f5c.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/framework-81da43a8dcd978d9.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/main-00ca3f3974f0a67a.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/pages/_app-4def5050ef33c1d2.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/369-eeb2b79f75cc27b6.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/pages/leviathan/leviathan1-78b2c6e04fc0d338.js" defer=""></script><script src="/over-the-wire/_next/static/u44jPsROl1F2g3PWwjTz3/_buildManifest.js" defer=""></script><script src="/over-the-wire/_next/static/u44jPsROl1F2g3PWwjTz3/_ssgManifest.js" defer=""></script><script src="/over-the-wire/_next/static/u44jPsROl1F2g3PWwjTz3/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><nav class="Nav_navBar__ioQlk"><ul class="Nav_navItems__n_3aD"><li class="Nav_navLink__4k_2G"><a href="/over-the-wire">Home</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/bandit">Bandit</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/natas">Natas</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/leviathan">Leviathan</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/narnia">Narnia</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/cipher">Cipher</a></li></ul></nav><div class="MainContainer_mainContainer__0FIFy"><div><h1>Leviathan 1</h1><div class="Keyword_keyword__javqt"><p class="Keyword_keywordHead__40fuD">Keywords: </p><span class="Tag_tag__AJnTY">ltrace</span></div><section><h2>Experience</h2><p>So, here we were greeted with an executable called &#x27;check&#x27;. A good first step, I ran the executable at which point it then prompted me for a password. So, somehow, we are supposed to find this password it is comparing to.</p><p>I tried looking at the data part of the program using<!-- --> <!-- --><code>objdump -s -j .rodata ./check</code>. This didn&#x27;t show anything beside the error prompt. I tried using GDB and analysing the comparison steps, putting a breakpoint at a call to strcmp and seeing the register informations, but I wasn&#x27;t able to find the string it is comparing to.<!-- --></p><p>After a good amount of time on looking at the assembly code, I researched other methods, I discovered that we can use <!-- --><code>ltrace</code> to basically see what library and system calls were made before the program exits.<!-- --></p><div class="BlogImage_imgContainer__s2tL6"><img src="/over-the-wire/images/leviathan1-1.png" alt="ltrace was used to show what arguments are given to strcmp" width="600"/></div><p>As seen, the correct password is &quot;sex&quot;. Using that password for the prompt, it appears to run a shell. So I tried using it to access <!-- --><code>/etc/leviathan_pass/leviathan2</code>. I simply used <!-- --><code>cat</code> with that path, and I received the password for the next level.<!-- --></p></section><section><h2>Reflection</h2><p>Reflecting on the time I took to complete this level, I feel that it might have been better to just search for answers. I spent way too much time trying to understand the assembly, when in reality, the level uses something that I didn&#x27;t know about. Spending time trying things out was great, but it prevents me from doing more levels and hence learn more in the long term.</p><p>In terms of security, it&#x27;s really about learning the many tools available to reverse engineer a program even when it is in compiled form. It may be difficult to do using gdb and objdump, so I was fooled into thinking that while possible it is very difficult, but there are many other programs built to analysed these codes. So, we should keep that in mind while writing programs. Stored company secret in a program for example could be found by doing such reverse engineering hence it might not be a good idea. For example, writing credentials inside a user program.</p></section><section><h2>Key</h2><div class="SpoilerKey_codeBlock__KWl0d"><div class="SpoilerKey_spoilerToggler__HCeWZ"><button>Click to Reveal</button></div><div class="SpoilerKey_spoilerContainer__O76It"><div class="SpoilerKey_spoiler__YWx_s "><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto;border-radius:0.3em"><code style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>ougahZi8Ta<!-- --></span></code></pre></div></div></div></section><div class="PageNav_pageNav__NXqbT"><div><a title="Previous page" class="PageNav_navButton__yHhmO" href="/over-the-wire/leviathan/leviathan0">◀</a></div><div><a title="Next page" class="PageNav_navButton__yHhmO" href="/over-the-wire/leviathan/leviathan2">▶</a></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/leviathan/leviathan1","query":{},"buildId":"u44jPsROl1F2g3PWwjTz3","assetPrefix":"/over-the-wire","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>