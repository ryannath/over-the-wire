<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/over-the-wire/_next/static/css/86b7aba7af294b94.css" as="style"/><link rel="stylesheet" href="/over-the-wire/_next/static/css/86b7aba7af294b94.css" data-n-g=""/><link rel="preload" href="/over-the-wire/_next/static/css/21a6889b2154d675.css" as="style"/><link rel="stylesheet" href="/over-the-wire/_next/static/css/21a6889b2154d675.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/over-the-wire/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/over-the-wire/_next/static/chunks/webpack-f6318ba5529f7f5c.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/framework-81da43a8dcd978d9.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/main-00ca3f3974f0a67a.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/pages/_app-4def5050ef33c1d2.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/369-eeb2b79f75cc27b6.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/pages/leviathan/leviathan3-2346aa5e26ce1447.js" defer=""></script><script src="/over-the-wire/_next/static/2JkGQH2wNQGe36PuLvh9v/_buildManifest.js" defer=""></script><script src="/over-the-wire/_next/static/2JkGQH2wNQGe36PuLvh9v/_ssgManifest.js" defer=""></script><script src="/over-the-wire/_next/static/2JkGQH2wNQGe36PuLvh9v/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><nav class="Nav_navBar__ioQlk"><ul class="Nav_navItems__n_3aD"><li class="Nav_navLink__4k_2G"><a href="/over-the-wire">Home</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/bandit">Bandit</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/natas">Natas</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/leviathan">Leviathan</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/narnia">Narnia</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/cipher">Cipher</a></li></ul></nav><div class="MainContainer_mainContainer__0FIFy"><div><h1>Leviathan 3</h1><section><h2>Experience</h2><p>Starting off, I used <!-- --><code>ltrace</code> as I ran the executable we have for this level. This provided me with the following output. I noticed that the initial <!-- --><code>strcmp</code>failed but does not seem to do anything. Then there is another<!-- --><code>strcmp</code> which compares my input &#x27;ya&#x27; with &#x27;snlprintf&#x27;.<!-- --></p><div class="CodeBlock_CodeBlock___IBBd"><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>leviathan3@leviathan:~$ ltrace ./level3
<!-- --></span>__libc_start_main(0x8048618, 1, 0xffffd784, 0x80486d0 &lt;unfinished ...&gt;
<!-- -->strcmp(&quot;h0no33&quot;, &quot;kakaka&quot;)                                                      = -1
<!-- -->printf(&quot;Enter the password&gt; &quot;)                                                  = 20
<!-- -->fgets(Enter the password&gt; ya
<!-- -->&quot;ya\n&quot;, 256, 0xf7fc55a0)                                                  = 0xffffd590
<!-- -->strcmp(&quot;ya\n&quot;, &quot;snlprintf\n&quot;)                                                   = 1
<!-- -->puts(&quot;bzzzzzzzzap. WRONG&quot;bzzzzzzzzap. WRONG
<!-- -->)                                                      = 19
<!-- -->+++ exited (status 0) +++<!-- --></code></pre></div><p>Therefore, I tried typing &quot;snlprintf&quot; instead as my input, that worked and a shell was opened where I simply <!-- --><code>cat</code> the password for leviathan4.<!-- --></p></section><section><h2>Reflection</h2><p>I suppose this is another example of how useful ltrace can be. Programs which compares inputs can be quite common and before learning about ltrace, I would have thought it was safe to do such a comparison. But as can be seen here, we could see exactly what our input is being compared with.</p></section><section><h2>Key</h2><div class="SpoilerKey_codeBlock__KWl0d"><div class="SpoilerKey_spoilerToggler__HCeWZ"><button>Click to Reveal</button></div><div class="SpoilerKey_spoilerContainer__O76It"><div class="SpoilerKey_spoiler__YWx_s "><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto;border-radius:0.3em"><code style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>vuH0coox6m<!-- --></span></code></pre></div></div></div></section><div class="PageNav_pageNav__NXqbT"><div><a title="Previous page" class="PageNav_navButton__yHhmO" href="/over-the-wire/leviathan/leviathan2">◀</a></div><div><a title="Next page" class="PageNav_navButton__yHhmO" href="/over-the-wire/leviathan/leviathan4">▶</a></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/leviathan/leviathan3","query":{},"buildId":"2JkGQH2wNQGe36PuLvh9v","assetPrefix":"/over-the-wire","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>