<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/over-the-wire/_next/static/css/cd35ccc2279f56b6.css" as="style"/><link rel="stylesheet" href="/over-the-wire/_next/static/css/cd35ccc2279f56b6.css" data-n-g=""/><link rel="preload" href="/over-the-wire/_next/static/css/dab4cb06b756ec9e.css" as="style"/><link rel="stylesheet" href="/over-the-wire/_next/static/css/dab4cb06b756ec9e.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/over-the-wire/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/over-the-wire/_next/static/chunks/webpack-f6318ba5529f7f5c.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/framework-81da43a8dcd978d9.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/main-00ca3f3974f0a67a.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/pages/_app-4def5050ef33c1d2.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/369-eeb2b79f75cc27b6.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/pages/leviathan/leviathan6-9b92f1b05b620cd3.js" defer=""></script><script src="/over-the-wire/_next/static/_GcHFI68j_pzSWqFQlkkD/_buildManifest.js" defer=""></script><script src="/over-the-wire/_next/static/_GcHFI68j_pzSWqFQlkkD/_ssgManifest.js" defer=""></script><script src="/over-the-wire/_next/static/_GcHFI68j_pzSWqFQlkkD/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><nav class="Nav_navBar__ioQlk"><ul class="Nav_navItems__n_3aD"><li class="Nav_navLink__4k_2G"><a href="/over-the-wire">Home</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/bandit">Bandit</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/natas">Natas</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/leviathan">Leviathan</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/narnia">Narnia</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/cipher">Cipher</a></li></ul></nav><div class="MainContainer_mainContainer__0FIFy"><div><h1>Leviathan 6</h1><div class="Keyword_keyword__javqt"><p class="Keyword_keywordHead__40fuD">Keywords: </p><span class="Tag_tag__AJnTY">brute-force</span></div><section><h2>Experience</h2><p>In this challenge, we are greeted with a pin protected executable. So I thought, well, it is possible to show what is being compared with gdb. I found the location of where it might be comparing the values.</p><div class="CodeBlock_CodeBlock___IBBd"><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>8048587:       e8 94 fe ff ff          call   8048420 &lt;atoi@plt&gt;
<!-- --></span>804858c:       83 c4 10                add    $0x10,%esp
<!-- -->804858f:       3b 45 f4                cmp    -0xc(%ebp),%eax
<!-- -->8048592:       75 2b                   jne    80485bf &lt;main+0x84&gt;<!-- --></code></pre></div><p>So, creating a breakpoint at 0x804858f, I found that the eax register holds our input, but unfortunately, I was not able to access the memory location -0xc. Here I got a little stuck again, but looking for hints, it appears that all that was expected was to brute force the pin and so I did. Writing a simple loop using shell script as seen below.</p><div class="CodeBlock_CodeBlock___IBBd"><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code class="language-shell" style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#8be9fd">for<!-- --></span><span> <!-- --></span><span class="token for-or-select" style="color:#f8f8f2">i<!-- --></span><span> <!-- --></span><span class="token" style="color:#8be9fd">in<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">{<!-- --></span><span class="token" style="color:#bd93f9">1<!-- --></span><span class="token" style="color:#f8f8f2">..<!-- --></span><span class="token" style="color:#bd93f9">9999<!-- --></span><span class="token" style="color:#f8f8f2">}<!-- --></span><span class="token" style="color:#f8f8f2">;<!-- --></span><span> <!-- --></span><span class="token" style="color:#8be9fd">do<!-- --></span><span> ~/leviathan6 <!-- --></span><span class="token" style="color:#f8f8f2">$i<!-- --></span><span class="token" style="color:#f8f8f2">;<!-- --></span><span> <!-- --></span><span class="token" style="color:#8be9fd">done<!-- --></span></code></pre></div><p>I had first written a similar loop using python as I am more comfortable with said language, however, it didn&#x27;t seem to execute all possible permutations. But, running this command, it will run the program until it finds the correct pin. When it did, it ran a shell, which I used to find the last password.</p></section><section><h2>Reflection</h2><p>This was where I had learnt that perhaps, when I am stuck, I should try to look for hints. Looking through the gdb and the assembly code, I was quite perplexed as to why it didn&#x27;t work, and what other methods could I have used which took quite a bit of time. However, after seeing a hint, I was able to fully do the challenge. The hint itself did not take away too much of the experience because I did not copy the code they used and I still had to do much of the rest myself, but it did provide me with new perspective.</p><p>Leviathan 6 was quite an interseting level, as it showed me how easy a 4 pin passcode could be broken. It barely took a couple of second, before the shell script was able to find the right permutation and open the shell. It was interesting because of how often things use 4 pin passcodes, for example phones, ATMs, computers, and financial apps. So I had thought that brute force would not be a viable solution. I learnt that as an attacker, we must not assume anything to not work until we have tried them. I was fully capable of writing a brute force attack, but the mere thought just did not occur to me. So I really found that, we should really attempt all ways to break things, even if it seem like not a viable solution.</p></section><section><h2>Key</h2><div class="SpoilerKey_codeBlock__KWl0d"><div class="SpoilerKey_spoilerToggler__HCeWZ"><button>Click to Reveal</button></div><div class="SpoilerKey_spoilerContainer__O76It"><div class="SpoilerKey_spoiler__YWx_s "><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto;border-radius:0.3em"><code style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>ahy7MaeBo9<!-- --></span></code></pre></div></div></div></section><div class="PageNav_pageNav__NXqbT"><div><a title="Previous page" class="PageNav_navButton__yHhmO" href="/over-the-wire/leviathan/leviathan5">◀</a></div><div><a title="Next page" class="PageNav_navButton__yHhmO" href="/over-the-wire/narnia">▶</a></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/leviathan/leviathan6","query":{},"buildId":"_GcHFI68j_pzSWqFQlkkD","assetPrefix":"/over-the-wire","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>