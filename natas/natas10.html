<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/over-the-wire/_next/static/css/86b7aba7af294b94.css" as="style"/><link rel="stylesheet" href="/over-the-wire/_next/static/css/86b7aba7af294b94.css" data-n-g=""/><link rel="preload" href="/over-the-wire/_next/static/css/fd7ddeb4cf1e4c12.css" as="style"/><link rel="stylesheet" href="/over-the-wire/_next/static/css/fd7ddeb4cf1e4c12.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/over-the-wire/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/over-the-wire/_next/static/chunks/webpack-f6318ba5529f7f5c.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/framework-81da43a8dcd978d9.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/main-00ca3f3974f0a67a.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/pages/_app-4def5050ef33c1d2.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/369-eeb2b79f75cc27b6.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/pages/natas/natas10-4e88123dc65ed9d7.js" defer=""></script><script src="/over-the-wire/_next/static/TmWtd237DlFkdcXSnvpQi/_buildManifest.js" defer=""></script><script src="/over-the-wire/_next/static/TmWtd237DlFkdcXSnvpQi/_ssgManifest.js" defer=""></script><script src="/over-the-wire/_next/static/TmWtd237DlFkdcXSnvpQi/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><nav class="Nav_navBar__ioQlk"><ul class="Nav_navItems__n_3aD"><li class="Nav_navLink__4k_2G"><a href="/over-the-wire">Home</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/bandit">Bandit</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/natas">Natas</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/leviathan">Leviathan</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/narnia">Narnia</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/cipher">Cipher</a></li></ul></nav><div class="MainContainer_mainContainer__0FIFy"><div><h1>Natas 10</h1><div class="Keyword_keyword__javqt"><p class="Keyword_keywordHead__40fuD">Keywords: </p><span class="Tag_tag__AJnTY">php</span></div><section><h2>Experience</h2><p>This is an upgraded version of natas9 where they have filtered certain characters out. This really links back to blacklisting, they have essentially blacklisted several characters.</p><div class="BlogImage_imgContainer__s2tL6"><img src="/over-the-wire/images/natas10-1.png" alt="Source code for natas10, showing the characters banned using regex, namely semicolon, pipe, and ampersand" width="600"/></div><p>The source code above shows a regular expression with the characters which have been blacklisted. This meant that our previous method of using a different command will not work. So, I looked into the <!-- --><code>grep</code> command more deeply this time around. One of the interesting thing I found was that you are allowed to provide several files to search through.<!-- --></p><p>Using this knowledge about grep, I used the command <!-- --><code>&quot;.&quot; /etc/natas_webpass/natas11</code>. The dot would match anything, and hence would match the content of natas11. This returned the password for natas11.<!-- --></p></section><section><h2>Reflection</h2><p>I thought this was quite difficult at the start since I was not familiar with the grep command. Furthermore, the usage of the regex pattern was a bit confusing in terms of its implementation. If we use <!-- --><code>.*</code> instead of treating this as a pattern, it seem that it treats it as files with a dot in front and anything afterwards (a wildcard). The reason behind this is that we are running a shell command and the star is used for globbing. But, after recognising what was going on, it was quite simple to get the key.<!-- --></p><p>As I&#x27;ve mentioned several time, blacklisting can be quite fragile. The blacklist used here only target things that uses other shell command like what I did in Natas 9. However, it does not account for other potential vulnerabilities such as grep itself. I think it is also important to notice that these extensive lists could provide an unearned sense of security and really solidifies a defender mindset rather than utilising an attacker mindset. By recognising this, we could think more freely in terms of what things should be included in the blacklist or if there are other methods that could be more effective.</p></section><section><h2>Key</h2><div class="SpoilerKey_codeBlock__KWl0d"><div class="SpoilerKey_spoilerToggler__HCeWZ"><button>Click to Reveal</button></div><div class="SpoilerKey_spoilerContainer__O76It"><div class="SpoilerKey_spoiler__YWx_s "><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto;border-radius:0.3em"><code style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>U82q5TCMMQ9xuFoI3dYX61s7OZD9JKoK<!-- --></span></code></pre></div></div></div></section><div class="PageNav_pageNav__NXqbT"><div><a title="Previous page" class="PageNav_navButton__yHhmO" href="/over-the-wire/natas/natas9">◀</a></div><div><a title="Next page" class="PageNav_navButton__yHhmO" href="/over-the-wire/natas/natas11">▶</a></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/natas/natas10","query":{},"buildId":"TmWtd237DlFkdcXSnvpQi","assetPrefix":"/over-the-wire","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>