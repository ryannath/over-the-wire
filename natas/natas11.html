<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/over-the-wire/_next/static/css/86b7aba7af294b94.css" as="style"/><link rel="stylesheet" href="/over-the-wire/_next/static/css/86b7aba7af294b94.css" data-n-g=""/><link rel="preload" href="/over-the-wire/_next/static/css/2a97f9c7fde1f37f.css" as="style"/><link rel="stylesheet" href="/over-the-wire/_next/static/css/2a97f9c7fde1f37f.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/over-the-wire/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/over-the-wire/_next/static/chunks/webpack-f6318ba5529f7f5c.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/framework-81da43a8dcd978d9.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/main-00ca3f3974f0a67a.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/pages/_app-4def5050ef33c1d2.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/369-eeb2b79f75cc27b6.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/pages/natas/natas11-2d0a776a9d677c34.js" defer=""></script><script src="/over-the-wire/_next/static/STFoTY5ZHPeRm1YrlssPY/_buildManifest.js" defer=""></script><script src="/over-the-wire/_next/static/STFoTY5ZHPeRm1YrlssPY/_ssgManifest.js" defer=""></script><script src="/over-the-wire/_next/static/STFoTY5ZHPeRm1YrlssPY/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><nav class="Nav_navBar__ioQlk"><ul class="Nav_navItems__n_3aD"><li class="Nav_navLink__4k_2G"><a href="/over-the-wire">Home</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/bandit">Bandit</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/natas">Natas</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/leviathan">Leviathan</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/narnia">Narnia</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/cipher">Cipher</a></li></ul></nav><div class="MainContainer_mainContainer__0FIFy"><div><h1>Natas 11</h1><div class="Keyword_keyword__javqt"><p class="Keyword_keywordHead__40fuD">Keywords: </p><span class="Tag_tag__AJnTY">encryption</span><span class="Tag_tag__AJnTY">cookie</span></div><section><h2>Experience</h2><p>Here we are greeted with something that is not obviously vulnerable. The input is merely to change a background color. However it does give us a hint to look into cookies. Looking at the source code, it uses the an encrypted cookie to determine whether the password should be shown or not. So first step was to get the cookie called data. This could be obtained from the Application tab of the developer tools, or simply using some Javascript.</p><div class="BlogImage_imgContainer__s2tL6"><img src="/over-the-wire/images/natas11-1.png" alt="obtaining cookies" width="450"/></div><p>Then, we analyse what is being done in the source code. There are many function definitions in between, but for the first case, it basically create a <!-- --><code>defaultdata</code> variable, then load that then save the return. The <!-- --><code>saveData</code> function simply sets the cookie to the argument it&#x27;s given. Another important thing to note is that it checks if the <!-- --><code>showpassword</code> key inside the cookie maps to a<!-- --><code>yes</code>, if so, it will print a password. So our goal, is to modify the cookie. The main problem is that we do not have the function to encrypt the cookie into the valid form required.<!-- --></p><div class="CodeBlock_CodeBlock___IBBd"><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code class="language-php" style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>$defaultdata = array( &quot;showpassword&quot;=&gt;&quot;no&quot;, &quot;bgcolor&quot;=&gt;&quot;#ffffff&quot;);
<!-- --></span>$data = loadData($defaultdata);
<!-- -->saveData($data);
<!-- -->
<!-- --><span></span><span class="token php language-php delimiter" style="color:#ffb86c;font-weight:bold">&lt;?<!-- --></span><span class="token php language-php">
<!-- --></span><span class="token php language-php"></span><span class="token php language-php" style="color:#8be9fd">if<!-- --></span><span class="token php language-php" style="color:#f8f8f2">(<!-- --></span><span class="token php language-php" style="color:#f8f8f2">$data<!-- --></span><span class="token php language-php" style="color:#f8f8f2">[<!-- --></span><span class="token php language-php double-quoted-string" style="color:#50fa7b">&quot;showpassword&quot;<!-- --></span><span class="token php language-php" style="color:#f8f8f2">]<!-- --></span><span class="token php language-php"> <!-- --></span><span class="token php language-php" style="color:#f8f8f2">==<!-- --></span><span class="token php language-php"> <!-- --></span><span class="token php language-php double-quoted-string" style="color:#50fa7b">&quot;yes&quot;<!-- --></span><span class="token php language-php" style="color:#f8f8f2">)<!-- --></span><span class="token php language-php"> <!-- --></span><span class="token php language-php" style="color:#f8f8f2">{<!-- --></span><span class="token php language-php">
<!-- --></span><span class="token php language-php">    <!-- --></span><span class="token php language-php" style="color:#8be9fd">print<!-- --></span><span class="token php language-php"> <!-- --></span><span class="token php language-php double-quoted-string" style="color:#50fa7b">&quot;The password for natas12 is &lt;censored&gt;&lt;br&gt;&quot;<!-- --></span><span class="token php language-php" style="color:#f8f8f2">;<!-- --></span><span class="token php language-php">
<!-- --></span><span class="token php language-php"></span><span class="token php language-php" style="color:#f8f8f2">}<!-- --></span><span class="token php language-php">
<!-- --></span><span class="token php language-php">
<!-- --></span><span class="token php language-php"></span><span class="token php language-php delimiter" style="color:#ffb86c;font-weight:bold">?&gt;<!-- --></span></code></pre></div><p>For now, we must examine the function <!-- --><code>loadData</code> and what it does.<!-- --></p><div class="CodeBlock_CodeBlock___IBBd"><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code class="language-php" style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#8be9fd">function<!-- --></span><span> <!-- --></span><span class="token function-definition" style="color:#f1fa8c">loadData<!-- --></span><span class="token" style="color:#f8f8f2">(<!-- --></span><span class="token" style="color:#f8f8f2">$def<!-- --></span><span class="token" style="color:#f8f8f2">)<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">{<!-- --></span><span>
<!-- --></span><span>    <!-- --></span><span class="token" style="color:#8be9fd">global<!-- --></span><span> <!-- --></span><span class="token global">$_COOKIE<!-- --></span><span class="token" style="color:#f8f8f2">;<!-- --></span><span>
<!-- --></span><span>    <!-- --></span><span class="token" style="color:#f8f8f2">$mydata<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">=<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">$def<!-- --></span><span class="token" style="color:#f8f8f2">;<!-- --></span><span>
<!-- --></span><span>    <!-- --></span><span class="token" style="color:#8be9fd">if<!-- --></span><span class="token" style="color:#f8f8f2">(<!-- --></span><span class="token" style="color:#f1fa8c">array_key_exists<!-- --></span><span class="token" style="color:#f8f8f2">(<!-- --></span><span class="token double-quoted-string" style="color:#50fa7b">&quot;data&quot;<!-- --></span><span class="token" style="color:#f8f8f2">,<!-- --></span><span> <!-- --></span><span class="token global">$_COOKIE<!-- --></span><span class="token" style="color:#f8f8f2">)<!-- --></span><span class="token" style="color:#f8f8f2">)<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">{<!-- --></span><span>
<!-- --></span><span>    <!-- --></span><span class="token" style="color:#f8f8f2">$tempdata<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">=<!-- --></span><span> <!-- --></span><span class="token" style="color:#f1fa8c">json_decode<!-- --></span><span class="token" style="color:#f8f8f2">(<!-- --></span><span class="token" style="color:#f1fa8c">xor_encrypt<!-- --></span><span class="token" style="color:#f8f8f2">(<!-- --></span><span class="token" style="color:#f1fa8c">base64_decode<!-- --></span><span class="token" style="color:#f8f8f2">(<!-- --></span><span class="token global">$_COOKIE<!-- --></span><span class="token" style="color:#f8f8f2">[<!-- --></span><span class="token double-quoted-string" style="color:#50fa7b">&quot;data&quot;<!-- --></span><span class="token" style="color:#f8f8f2">]<!-- --></span><span class="token" style="color:#f8f8f2">)<!-- --></span><span class="token" style="color:#f8f8f2">)<!-- --></span><span class="token" style="color:#f8f8f2">,<!-- --></span><span> <!-- --></span><span class="token" style="color:#bd93f9">true<!-- --></span><span class="token" style="color:#f8f8f2">)<!-- --></span><span class="token" style="color:#f8f8f2">;<!-- --></span><span>
<!-- --></span><span>    <!-- --></span><span class="token" style="color:#8be9fd">if<!-- --></span><span class="token" style="color:#f8f8f2">(<!-- --></span><span class="token" style="color:#f1fa8c">is_array<!-- --></span><span class="token" style="color:#f8f8f2">(<!-- --></span><span class="token" style="color:#f8f8f2">$tempdata<!-- --></span><span class="token" style="color:#f8f8f2">)<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">&amp;&amp;<!-- --></span><span> <!-- --></span><span class="token" style="color:#f1fa8c">array_key_exists<!-- --></span><span class="token" style="color:#f8f8f2">(<!-- --></span><span class="token double-quoted-string" style="color:#50fa7b">&quot;showpassword&quot;<!-- --></span><span class="token" style="color:#f8f8f2">,<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">$tempdata<!-- --></span><span class="token" style="color:#f8f8f2">)<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">&amp;&amp;<!-- --></span><span> <!-- --></span><span class="token" style="color:#f1fa8c">array_key_exists<!-- --></span><span class="token" style="color:#f8f8f2">(<!-- --></span><span class="token double-quoted-string" style="color:#50fa7b">&quot;bgcolor&quot;<!-- --></span><span class="token" style="color:#f8f8f2">,<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">$tempdata<!-- --></span><span class="token" style="color:#f8f8f2">)<!-- --></span><span class="token" style="color:#f8f8f2">)<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">{<!-- --></span><span>
<!-- --></span><span>        <!-- --></span><span class="token" style="color:#8be9fd">if<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">(<!-- --></span><span class="token" style="color:#f1fa8c">preg_match<!-- --></span><span class="token" style="color:#f8f8f2">(<!-- --></span><span class="token single-quoted-string" style="color:#50fa7b">&#x27;/^#(?:[a-fd]{6})$/i&#x27;<!-- --></span><span class="token" style="color:#f8f8f2">,<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">$tempdata<!-- --></span><span class="token" style="color:#f8f8f2">[<!-- --></span><span class="token single-quoted-string" style="color:#50fa7b">&#x27;bgcolor&#x27;<!-- --></span><span class="token" style="color:#f8f8f2">]<!-- --></span><span class="token" style="color:#f8f8f2">)<!-- --></span><span class="token" style="color:#f8f8f2">)<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">{<!-- --></span><span>
<!-- --></span><span>        <!-- --></span><span class="token" style="color:#f8f8f2">$mydata<!-- --></span><span class="token" style="color:#f8f8f2">[<!-- --></span><span class="token single-quoted-string" style="color:#50fa7b">&#x27;showpassword&#x27;<!-- --></span><span class="token" style="color:#f8f8f2">]<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">=<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">$tempdata<!-- --></span><span class="token" style="color:#f8f8f2">[<!-- --></span><span class="token single-quoted-string" style="color:#50fa7b">&#x27;showpassword&#x27;<!-- --></span><span class="token" style="color:#f8f8f2">]<!-- --></span><span class="token" style="color:#f8f8f2">;<!-- --></span><span>
<!-- --></span><span>        <!-- --></span><span class="token" style="color:#f8f8f2">$mydata<!-- --></span><span class="token" style="color:#f8f8f2">[<!-- --></span><span class="token single-quoted-string" style="color:#50fa7b">&#x27;bgcolor&#x27;<!-- --></span><span class="token" style="color:#f8f8f2">]<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">=<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">$tempdata<!-- --></span><span class="token" style="color:#f8f8f2">[<!-- --></span><span class="token single-quoted-string" style="color:#50fa7b">&#x27;bgcolor&#x27;<!-- --></span><span class="token" style="color:#f8f8f2">]<!-- --></span><span class="token" style="color:#f8f8f2">;<!-- --></span><span>
<!-- --></span><span>        <!-- --></span><span class="token" style="color:#f8f8f2">}<!-- --></span><span>
<!-- --></span><span>    <!-- --></span><span class="token" style="color:#f8f8f2">}<!-- --></span><span>
<!-- --></span><span>    <!-- --></span><span class="token" style="color:#f8f8f2">}<!-- --></span><span>
<!-- --></span><span>    <!-- --></span><span class="token" style="color:#8be9fd">return<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">$mydata<!-- --></span><span class="token" style="color:#f8f8f2">;<!-- --></span><span>
<!-- --></span><span></span><span class="token" style="color:#f8f8f2">}<!-- --></span></code></pre></div><p><code>loadData</code> is a sizeable function, however, the main thing to consider is that it uses the <!-- --><code>xor_encrypt</code> function. So, what is an XOR encryption?<!-- --></p><div class="CodeBlock_CodeBlock___IBBd"><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code class="language-php" style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#8be9fd">function<!-- --></span><span> <!-- --></span><span class="token function-definition" style="color:#f1fa8c">xor_encrypt<!-- --></span><span class="token" style="color:#f8f8f2">(<!-- --></span><span class="token" style="color:#f8f8f2">$in<!-- --></span><span class="token" style="color:#f8f8f2">)<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">{<!-- --></span><span>
<!-- --></span><span>    <!-- --></span><span class="token" style="color:#f8f8f2">$key<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">=<!-- --></span><span> <!-- --></span><span class="token single-quoted-string" style="color:#50fa7b">&#x27;&lt;censored&gt;&#x27;<!-- --></span><span class="token" style="color:#f8f8f2">;<!-- --></span><span>
<!-- --></span><span>    <!-- --></span><span class="token" style="color:#f8f8f2">$text<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">=<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">$in<!-- --></span><span class="token" style="color:#f8f8f2">;<!-- --></span><span>
<!-- --></span><span>    <!-- --></span><span class="token" style="color:#f8f8f2">$outText<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">=<!-- --></span><span> <!-- --></span><span class="token single-quoted-string" style="color:#50fa7b">&#x27;&#x27;<!-- --></span><span class="token" style="color:#f8f8f2">;<!-- --></span><span>
<!-- --></span>
<!-- --><span>    <!-- --></span><span class="token" style="color:#6272a4">// Iterate through each character<!-- --></span><span>
<!-- --></span><span>    <!-- --></span><span class="token" style="color:#8be9fd">for<!-- --></span><span class="token" style="color:#f8f8f2">(<!-- --></span><span class="token" style="color:#f8f8f2">$i<!-- --></span><span class="token" style="color:#f8f8f2">=<!-- --></span><span class="token" style="color:#bd93f9">0<!-- --></span><span class="token" style="color:#f8f8f2">;<!-- --></span><span class="token" style="color:#f8f8f2">$i<!-- --></span><span class="token" style="color:#f8f8f2">&lt;<!-- --></span><span class="token" style="color:#f1fa8c">strlen<!-- --></span><span class="token" style="color:#f8f8f2">(<!-- --></span><span class="token" style="color:#f8f8f2">$text<!-- --></span><span class="token" style="color:#f8f8f2">)<!-- --></span><span class="token" style="color:#f8f8f2">;<!-- --></span><span class="token" style="color:#f8f8f2">$i<!-- --></span><span class="token" style="color:#f8f8f2">++<!-- --></span><span class="token" style="color:#f8f8f2">)<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">{<!-- --></span><span>
<!-- --></span><span>    <!-- --></span><span class="token" style="color:#f8f8f2">$outText<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">.=<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">$text<!-- --></span><span class="token" style="color:#f8f8f2">[<!-- --></span><span class="token" style="color:#f8f8f2">$i<!-- --></span><span class="token" style="color:#f8f8f2">]<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">^<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">$key<!-- --></span><span class="token" style="color:#f8f8f2">[<!-- --></span><span class="token" style="color:#f8f8f2">$i<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">%<!-- --></span><span> <!-- --></span><span class="token" style="color:#f1fa8c">strlen<!-- --></span><span class="token" style="color:#f8f8f2">(<!-- --></span><span class="token" style="color:#f8f8f2">$key<!-- --></span><span class="token" style="color:#f8f8f2">)<!-- --></span><span class="token" style="color:#f8f8f2">]<!-- --></span><span class="token" style="color:#f8f8f2">;<!-- --></span><span>
<!-- --></span><span>    <!-- --></span><span class="token" style="color:#f8f8f2">}<!-- --></span><span>
<!-- --></span>
<!-- --><span>    <!-- --></span><span class="token" style="color:#8be9fd">return<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">$outText<!-- --></span><span class="token" style="color:#f8f8f2">;<!-- --></span><span>
<!-- --></span><span></span><span class="token" style="color:#f8f8f2">}<!-- --></span></code></pre></div><p>Looking at the code, is simply performs exclusive or (XOR) on the text with some ssecret key. With background knowledge on XOR, we know that XOR is reversible.</p><div class="CodeBlock_CodeBlock___IBBd"><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>10 XOR 11 --&gt; 01
<!-- --></span>11 XOR 01 --&gt; 10
<!-- -->--------------------
<!-- -->in other words:
<!-- -->A XOR B = C
<!-- -->B XOR C = A<!-- --></code></pre></div><p>Now, we know the default and we also have access to the resulting cookie. All we are missing is the key. Using the principle of how XOR works, I XOR the default data and it&#x27;s respective XOR cookie.</p><div class="BlogImage_imgContainer__s2tL6"><img src="/over-the-wire/images/natas11-2.png" alt="Code used to get the key" width="600"/></div><div class="BlogImage_imgContainer__s2tL6"><img src="/over-the-wire/images/natas11-3.png" alt="Key used by xor encrypt" width="600"/></div><p>From the code of the encryptiong function, we know that it simply repeats itself, this is another potential way of finding the key if it didn&#x27;t have that reversible property. Therefore, the key is simply just <!-- --><code>qw8J</code>. We may then fill in the key inside the encryption function then create our own cookie where the<!-- --> <!-- --><code>showpassword</code> key has a value of <!-- --><code>yes</code></p><div class="BlogImage_imgContainer__s2tL6"><img src="/over-the-wire/images/natas11-4.png" alt="" width="600"/></div><div class="BlogImage_imgContainer__s2tL6"><img src="/over-the-wire/images/natas11-5.png" alt="" width="600"/></div><div class="BlogImage_imgContainer__s2tL6"><img src="/over-the-wire/images/natas11-66.png" alt="" width="600"/></div><p>The last picture above shows the cookie, not the password for the next level. So then, we can set the cookie via the developer tools and reload the page to get the password.</p></section><section><h2>Reflection</h2><p>I think this was an example of breaking an encryption only using the start and end result. If the encryption is not as simple, I could picture breaking it just by comparison, as you would be allowed to set the background colour to anything and analysed how it changed the cookie. This might be difficult, but it seem quite possible.</p><p>In regards to perspective, it was quite shocking how even for a website that changes background colour, there are these potential loop holes that I would have never thought about as a developer of the website. Using cookies can definitely be quite vulnerable as seen in this case as they are changeable, so it&#x27;s really about ensuring that the encryption is difficult to break.</p></section><section><h2>Key</h2><div class="SpoilerKey_codeBlock__KWl0d"><div class="SpoilerKey_spoilerToggler__HCeWZ"><button>Click to Reveal</button></div><div class="SpoilerKey_spoilerContainer__O76It"><div class="SpoilerKey_spoiler__YWx_s "><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto;border-radius:0.3em"><code style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>EDXp0pS26wLKHZy1rDBPUZk0RKfLGIR3<!-- --></span></code></pre></div></div></div></section><div class="PageNav_pageNav__NXqbT"><div><a title="Previous page" class="PageNav_navButton__yHhmO" href="natas10">◀</a></div><div><a title="Next page" class="PageNav_navButton__yHhmO" href="natas12">▶</a></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/natas/natas11","query":{},"buildId":"STFoTY5ZHPeRm1YrlssPY","assetPrefix":"/over-the-wire","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>