<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/over-the-wire/_next/static/css/86b7aba7af294b94.css" as="style"/><link rel="stylesheet" href="/over-the-wire/_next/static/css/86b7aba7af294b94.css" data-n-g=""/><link rel="preload" href="/over-the-wire/_next/static/css/dab4cb06b756ec9e.css" as="style"/><link rel="stylesheet" href="/over-the-wire/_next/static/css/dab4cb06b756ec9e.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/over-the-wire/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/over-the-wire/_next/static/chunks/webpack-f6318ba5529f7f5c.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/framework-81da43a8dcd978d9.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/main-00ca3f3974f0a67a.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/pages/_app-4def5050ef33c1d2.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/369-eeb2b79f75cc27b6.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/pages/natas/natas14-343da5123a47c945.js" defer=""></script><script src="/over-the-wire/_next/static/4Ji0R6oAyFwF_27HCAkm4/_buildManifest.js" defer=""></script><script src="/over-the-wire/_next/static/4Ji0R6oAyFwF_27HCAkm4/_ssgManifest.js" defer=""></script><script src="/over-the-wire/_next/static/4Ji0R6oAyFwF_27HCAkm4/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><nav class="Nav_navBar__ioQlk"><ul class="Nav_navItems__n_3aD"><li class="Nav_navLink__4k_2G"><a href="/over-the-wire">Home</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/bandit">Bandit</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/natas">Natas</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/leviathan">Leviathan</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/narnia">Narnia</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/cipher">Cipher</a></li></ul></nav><div class="MainContainer_mainContainer__0FIFy"><div><h1>Natas 14</h1><div class="Keyword_keyword__javqt"><p class="Keyword_keywordHead__40fuD">Keywords: </p><span class="Tag_tag__AJnTY">sqli</span></div><section><h2>Experience</h2><p>In this level, we are supposed to type in a username and a password, which if correct would return the key for the next level. The code as to how this is done can be seen below.</p><div class="CodeBlock_CodeBlock___IBBd"><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code class="language-php" style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#f8f8f2">$query<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">=<!-- --></span><span> <!-- --></span><span class="token double-quoted-string" style="color:#50fa7b">&quot;SELECT * from users where username=\&quot;&quot;<!-- --></span><span class="token" style="color:#f8f8f2">.<!-- --></span><span class="token global">$_REQUEST<!-- --></span><span class="token" style="color:#f8f8f2">[<!-- --></span><span class="token double-quoted-string" style="color:#50fa7b">&quot;username&quot;<!-- --></span><span class="token" style="color:#f8f8f2">]<!-- --></span><span class="token" style="color:#f8f8f2">.<!-- --></span><span class="token double-quoted-string" style="color:#50fa7b">&quot;\&quot; and password=\&quot;&quot;<!-- --></span><span class="token" style="color:#f8f8f2">.<!-- --></span><span class="token global">$_REQUEST<!-- --></span><span class="token" style="color:#f8f8f2">[<!-- --></span><span class="token double-quoted-string" style="color:#50fa7b">&quot;password&quot;<!-- --></span><span class="token" style="color:#f8f8f2">]<!-- --></span><span class="token" style="color:#f8f8f2">.<!-- --></span><span class="token double-quoted-string" style="color:#50fa7b">&quot;\&quot;&quot;<!-- --></span><span class="token" style="color:#f8f8f2">;<!-- --></span><span>
<!-- --></span><span></span><span class="token" style="color:#8be9fd">if<!-- --></span><span class="token" style="color:#f8f8f2">(<!-- --></span><span class="token" style="color:#f1fa8c">array_key_exists<!-- --></span><span class="token" style="color:#f8f8f2">(<!-- --></span><span class="token double-quoted-string" style="color:#50fa7b">&quot;debug&quot;<!-- --></span><span class="token" style="color:#f8f8f2">,<!-- --></span><span> <!-- --></span><span class="token global">$_GET<!-- --></span><span class="token" style="color:#f8f8f2">)<!-- --></span><span class="token" style="color:#f8f8f2">)<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">{<!-- --></span><span>
<!-- --></span><span></span><span class="token" style="color:#8be9fd">echo<!-- --></span><span> <!-- --></span><span class="token double-quoted-string" style="color:#50fa7b">&quot;Executing query: <!-- --></span><span class="token double-quoted-string interpolation" style="color:#f8f8f2">$query<!-- --></span><span class="token double-quoted-string" style="color:#50fa7b">&lt;br&gt;&quot;<!-- --></span><span class="token" style="color:#f8f8f2">;<!-- --></span><span>
<!-- --></span><span></span><span class="token" style="color:#f8f8f2">}<!-- --></span><span>
<!-- --></span>
<!-- --><span></span><span class="token" style="color:#8be9fd">if<!-- --></span><span class="token" style="color:#f8f8f2">(<!-- --></span><span class="token" style="color:#f1fa8c">mysql_num_rows<!-- --></span><span class="token" style="color:#f8f8f2">(<!-- --></span><span class="token" style="color:#f1fa8c">mysql_query<!-- --></span><span class="token" style="color:#f8f8f2">(<!-- --></span><span class="token" style="color:#f8f8f2">$query<!-- --></span><span class="token" style="color:#f8f8f2">,<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">$link<!-- --></span><span class="token" style="color:#f8f8f2">)<!-- --></span><span class="token" style="color:#f8f8f2">)<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">&gt;<!-- --></span><span> <!-- --></span><span class="token" style="color:#bd93f9">0<!-- --></span><span class="token" style="color:#f8f8f2">)<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">{<!-- --></span><span>
<!-- --></span><span>  <!-- --></span><span class="token" style="color:#8be9fd">echo<!-- --></span><span> <!-- --></span><span class="token double-quoted-string" style="color:#50fa7b">&quot;Successful login! The password for natas15 is &lt;censored&gt;&lt;br&gt;&quot;<!-- --></span><span class="token" style="color:#f8f8f2">;<!-- --></span><span>
<!-- --></span><span></span><span class="token" style="color:#f8f8f2">}<!-- --></span><span> <!-- --></span><span class="token" style="color:#8be9fd">else<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">{<!-- --></span><span>
<!-- --></span><span>  <!-- --></span><span class="token" style="color:#8be9fd">echo<!-- --></span><span> <!-- --></span><span class="token double-quoted-string" style="color:#50fa7b">&quot;Access denied!&lt;br&gt;&quot;<!-- --></span><span class="token" style="color:#f8f8f2">;<!-- --></span><span>
<!-- --></span><span></span><span class="token" style="color:#f8f8f2">}<!-- --></span></code></pre></div><p>It puts the user inputs and insert them to a string to be used as an sql query. Now the query itself can be quite confusing to read, so first, I would convert it to a more readable format.</p><div class="CodeBlock_CodeBlock___IBBd"><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code class="language-sql" style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#8be9fd">SELECT<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">*<!-- --></span><span> <!-- --></span><span class="token" style="color:#8be9fd">from<!-- --></span><span> users <!-- --></span><span class="token" style="color:#8be9fd">where<!-- --></span><span> username<!-- --></span><span class="token" style="color:#f8f8f2">=<!-- --></span><span class="token" style="color:#50fa7b">&quot;USERNAME&quot;<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">and<!-- --></span><span> password<!-- --></span><span class="token" style="color:#f8f8f2">=<!-- --></span><span class="token" style="color:#50fa7b">&quot;PASSWORD&quot;<!-- --></span></code></pre></div><p>The string USERNAME and PASSWORD would be where our inputs would actually go. From here, it is a lot clearer that if we want to write a statement that always succeed, we could do so by typing <!-- --><code>&quot; OR 1 #</code>. The first double quote ends the username query, then we insert the OR keyword and use the truthy 1, then we simply comment out the rest, that is the <!-- --><code>&quot; and password=&quot;PASSWORD&quot;</code>.<!-- --></p></section><section><h2>Reflection</h2><p>This was quite an easy SQL injection example, and we essentially escaped the location where we were supposed to insert the username by inserting a double quote, allowing us to then write any arbitrary command afterwards. This is another example of having to be careful when asking for user inputs that will be a part of an executed command. Without all the background knowledge of SQL injection, this type of inserting input would actually seem quite familiar.</p></section><section><h2>Key</h2><div class="SpoilerKey_codeBlock__KWl0d"><div class="SpoilerKey_spoilerToggler__HCeWZ"><button>Click to Reveal</button></div><div class="SpoilerKey_spoilerContainer__O76It"><div class="SpoilerKey_spoiler__YWx_s "><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto;border-radius:0.3em"><code style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>AwWj0w5cvxrZiONgZ9J5stNVkmxdk39J<!-- --></span></code></pre></div></div></div></section><div class="PageNav_pageNav__NXqbT"><div><a title="Previous page" class="PageNav_navButton__yHhmO" href="/over-the-wire/natas/natas13">◀</a></div><div><a title="Next page" class="PageNav_navButton__yHhmO" href="/over-the-wire/natas/natas15">▶</a></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/natas/natas14","query":{},"buildId":"4Ji0R6oAyFwF_27HCAkm4","assetPrefix":"/over-the-wire","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>