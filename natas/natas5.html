<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/over-the-wire/_next/static/css/86b7aba7af294b94.css" as="style"/><link rel="stylesheet" href="/over-the-wire/_next/static/css/86b7aba7af294b94.css" data-n-g=""/><link rel="preload" href="/over-the-wire/_next/static/css/22ea4df53befd5af.css" as="style"/><link rel="stylesheet" href="/over-the-wire/_next/static/css/22ea4df53befd5af.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/over-the-wire/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/over-the-wire/_next/static/chunks/webpack-f6318ba5529f7f5c.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/framework-fc97f3f1282ce3ed.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/main-8b89489e3a2f12b2.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/pages/_app-47bcf3974bbf8090.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/369-def532afa98a65d4.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/pages/natas/natas5-82c2890ae2b8c9d1.js" defer=""></script><script src="/over-the-wire/_next/static/l8XaLgAlkkzFoKDSNvmzO/_buildManifest.js" defer=""></script><script src="/over-the-wire/_next/static/l8XaLgAlkkzFoKDSNvmzO/_ssgManifest.js" defer=""></script><script src="/over-the-wire/_next/static/l8XaLgAlkkzFoKDSNvmzO/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><nav class="Nav_navBar__ioQlk"><ul class="Nav_navItems__n_3aD"><li class="Nav_navLink__4k_2G"><a href="/over-the-wire">Home</a></li><li class="Nav_navLink__4k_2G"><a title="previous" href="/over-the-wire/bandit">Bandit</a></li><li class="Nav_navLink__4k_2G"><a title="next" href="/over-the-wire/natas">Natas</a></li></ul></nav><div class="MainContainer_mainContainer__0FIFy"><div><h1>Natas 5</h1><section><h2>Experience</h2><p>In this capture the flag, we are greeted by yet another puzzling statement about how we are not logged in.</p><div class="BlogImage_imgContainer__s2tL6"><img src="/over-the-wire/images/natas5-1.png" alt="Page reads &quot;access disallowed. You are not logged in&quot;" width="600"/></div><p>I was actually quite unsure on what to do specifically. I checked the page&#x27;s source code to see if there were some hints again like last time. Unfortunately there wasn&#x27; any. So I thought, what web related technology is used to check if we are logged in. By asking myself, I meant, ask Google that very question. As expected, there has been plenty of people who has asked the same question, one instance is at the popular question asking website,<!-- --><a href="https://www.quora.com/How-do-websites-remember-you-are-logged-in">Quora</a>. The answer was cookie!.<!-- --></p><div class="BlogImage_imgContainer__s2tL6"><img src="/over-the-wire/images/natas5-2.png/" alt="Cookie shown on the developer tools" width="600"/></div><p>Most of the cookies seem to be quite cryptic, except one named &quot;loggedin&quot;. The loggedin cookie has a value of 0. So I searched up ways to make that 0 to a 1. Apparently, it was as simple as changing it on the developer tools and then reloading the site, then there it was, the password.</p><p>To challenge myself, I also tried to get the cookie via Javascript. I learnt that you can use the following command to change that cookie. This was actually quite peculiar, more about it in the research section.</p><div class="CodeBlock_CodeBlock___IBBd"><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code class="language-javascript" style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token dom" style="color:#f8f8f2">document<!-- --></span><span class="token" style="color:#f8f8f2">.<!-- --></span><span class="token property-access">cookie<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">=<!-- --></span><span> <!-- --></span><span class="token" style="color:#50fa7b">&#x27;loggin=1&#x27;<!-- --></span></code></pre></div></section><section><h2>Research</h2><a href="https://www.kaspersky.com/resource-center/definitions/cookies">Kaspersky</a><p>What are cookies? Cookies are just some stored data which assist websites in identifying who you are. The type of data which they store may vary. It really depends on the website you go to. But they are generally used for things like giving visitors a more personalised experience, remembering your past activities so you can get right back at where you left off, your likes and dislikes to target you with more relevant content, remembering credentials so you don&#x27;t have to login everytime, or store your shopping carts. It is noticeable that, even with these justifications, it is a little scary how much data they may store about you. They can even store things such as the length of time you&#x27;ve spent on their websites. Now fortunately, not everyone can read each other&#x27;s cookies, the cookies made by one domain is limited to be read and edited by the same domain.</p><p>Unfortunately, there exists another type of cookie, third party cookies. Third party cookies refer to cookies left not by the primary domain you are looking at. For examples, if you are looking at a website and that website has several ads, the provider of the ads may store cookies on you. This may also include other third party services the website uses. They should still not have access to the cookies of the website you&#x27;re looking at, however, this could leave what is called a cookie trail. If the third party service exist in many websites you visit, they will be able to paint quite an accurate picture of who you are.</p><p>Now regarding why I said it was interesting how cookies are set using Javascript is that although <!-- --><code>document.cookie</code> appear to return a string, I couldn&#x27;t change it like a normal string. I know strings are immutable in Javascript, but what I meant was that I couldn&#x27;t change what the string point towards. I had to look around to see how to actually change it. The syntax to change cookies is a bit weird, you merely let <!-- --><code>document.cookie</code> equal a string which has a key and a value, as seen in the code i used.<!-- --></p></section><section><h2>Reflection</h2><p>This was quite an eye opening activity. As you can guess by now, I am not so much focused on the capture the flag task specifically, but I am also trying to learn the technology behind it and get a little bit more context. I started this project because, I did not know that much about security, so I think it is important to see each technology in depth.</p><p>Cookies are quite interesting after learning about it, I never knew you could change your own cookie, albeit this will probably very very difficult considering most cookies seem hashed or at least encrypted. But it is definitely possible that perhaps some websites does not create such high quality cookies that could be easily read. I guess as security engineer, this might pose a risk, if we rely on cookies heavily to do authentication, if an attacker was able to just copy an authorised cookie, they could access the software and this again emphasise how harmful Cross Site Scripting (XSS) can be as they may get your cookies.</p><p>As a user, it is definitely scary to see how much data these websites actually collect. It make sense for them to collect such data, but often do not contemplate too much about it. With a collection of cookies, one could definitely paint a realistic picture of who you are. In addition, third party cookies, allow them to essentially stalk your internet activity if you encounter their ads often.</p></section><section><h2>Key</h2><div class="SpoilerKey_codeBlock__KWl0d"><div class="SpoilerKey_spoilerToggler__HCeWZ"><button>Click to Reveal</button></div><div class="SpoilerKey_spoilerContainer__O76It"><div class="SpoilerKey_spoiler__YWx_s "><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto;border-radius:0.3em"><code style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>aGoY4q2Dc6MgDq4oL4YtoKtyAg9PeHa1<!-- --></span></code></pre></div></div></div></section><div class="PageNav_pageNav__NXqbT"><div><a title="Previous page" class="PageNav_navButton__yHhmO" href="natas4">◀</a></div><div><a title="Next page" class="PageNav_navButton__yHhmO" href="natas6">▶</a></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/natas/natas5","query":{},"buildId":"l8XaLgAlkkzFoKDSNvmzO","assetPrefix":"/over-the-wire","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>