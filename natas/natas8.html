<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/over-the-wire/_next/static/css/86b7aba7af294b94.css" as="style"/><link rel="stylesheet" href="/over-the-wire/_next/static/css/86b7aba7af294b94.css" data-n-g=""/><link rel="preload" href="/over-the-wire/_next/static/css/dab4cb06b756ec9e.css" as="style"/><link rel="stylesheet" href="/over-the-wire/_next/static/css/dab4cb06b756ec9e.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/over-the-wire/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/over-the-wire/_next/static/chunks/webpack-f6318ba5529f7f5c.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/framework-fc97f3f1282ce3ed.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/main-8b89489e3a2f12b2.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/pages/_app-e4afc92eb7c56497.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/369-def532afa98a65d4.js" defer=""></script><script src="/over-the-wire/_next/static/chunks/pages/natas/natas8-f92fafba95c21de7.js" defer=""></script><script src="/over-the-wire/_next/static/mae6w2jHhzZ9g4pmj3DgN/_buildManifest.js" defer=""></script><script src="/over-the-wire/_next/static/mae6w2jHhzZ9g4pmj3DgN/_ssgManifest.js" defer=""></script><script src="/over-the-wire/_next/static/mae6w2jHhzZ9g4pmj3DgN/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><nav class="Nav_navBar__ioQlk"><ul class="Nav_navItems__n_3aD"><li class="Nav_navLink__4k_2G"><a href="/over-the-wire">Home</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/bandit">Bandit</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/natas">Natas</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/leviathan">Leviathan</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/narnia">Narnia</a></li><li class="Nav_navLink__4k_2G"><a href="/over-the-wire/cipher">Cipher</a></li></ul></nav><div class="MainContainer_mainContainer__0FIFy"><div><h1>Natas 8</h1><div class="Keyword_keyword__javqt"><p class="Keyword_keywordHead__40fuD">Keywords: </p><span class="Tag_tag__AJnTY">php</span><span class="Tag_tag__AJnTY">encoding</span></div><section><h2>Experience</h2><p>A similar screen greets us like in natas6, asking for an input. Unlike natas6, when we look at the source code, the secret is available to us but appears encoded.</p><p>Looking straight to the source code, I knew the key was in the following lines:</p><div class="CodeBlock_CodeBlock___IBBd"><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code class="language-php" style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#f8f8f2">$encodedSecret<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">=<!-- --></span><span> <!-- --></span><span class="token double-quoted-string" style="color:#50fa7b">&quot;3d3d516343746d4d6d6c315669563362&quot;<!-- --></span><span class="token" style="color:#f8f8f2">;<!-- --></span><span>
<!-- --></span><span></span><span class="token" style="color:#8be9fd">function<!-- --></span><span> <!-- --></span><span class="token function-definition" style="color:#f1fa8c">encodeSecret<!-- --></span><span class="token" style="color:#f8f8f2">(<!-- --></span><span class="token" style="color:#f8f8f2">$secret<!-- --></span><span class="token" style="color:#f8f8f2">)<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">{<!-- --></span><span>
<!-- --></span><span>    <!-- --></span><span class="token" style="color:#8be9fd">return<!-- --></span><span> <!-- --></span><span class="token" style="color:#f1fa8c">bin2hex<!-- --></span><span class="token" style="color:#f8f8f2">(<!-- --></span><span class="token" style="color:#f1fa8c">strrev<!-- --></span><span class="token" style="color:#f8f8f2">(<!-- --></span><span class="token" style="color:#f1fa8c">base64_encode<!-- --></span><span class="token" style="color:#f8f8f2">(<!-- --></span><span class="token" style="color:#f8f8f2">$secret<!-- --></span><span class="token" style="color:#f8f8f2">)<!-- --></span><span class="token" style="color:#f8f8f2">)<!-- --></span><span class="token" style="color:#f8f8f2">)<!-- --></span><span class="token" style="color:#f8f8f2">;<!-- --></span><span>
<!-- --></span><span></span><span class="token" style="color:#f8f8f2">}<!-- --></span></code></pre></div><p>I tried using other tools which are supposed to do what each of the php functions seem to do with no luck. So at the end, I thought, why not just use php. Using an <!-- --><a href="https://sandbox.onlinephpfunctions.com/">online php editor</a> I basically reversed the the encoding using corresponding decoding functions.<!-- --></p><div class="CodeBlock_CodeBlock___IBBd"><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code class="language-php" style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#f8f8f2">$encodedSecret<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">=<!-- --></span><span> <!-- --></span><span class="token double-quoted-string" style="color:#50fa7b">&quot;3d3d516343746d4d6d6c315669563362&quot;<!-- --></span><span class="token" style="color:#f8f8f2">;<!-- --></span><span>
<!-- --></span><span></span><span class="token" style="color:#f8f8f2">$decodedSecret<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">=<!-- --></span><span> <!-- --></span><span class="token" style="color:#f1fa8c">base64_decode<!-- --></span><span class="token" style="color:#f8f8f2">(<!-- --></span><span class="token" style="color:#f1fa8c">strrev<!-- --></span><span class="token" style="color:#f8f8f2">(<!-- --></span><span class="token" style="color:#f1fa8c">hex2bin<!-- --></span><span class="token" style="color:#f8f8f2">(<!-- --></span><span class="token" style="color:#f8f8f2">$encodedSecret<!-- --></span><span class="token" style="color:#f8f8f2">)<!-- --></span><span class="token" style="color:#f8f8f2">)<!-- --></span><span class="token" style="color:#f8f8f2">)<!-- --></span><span class="token" style="color:#f8f8f2">;<!-- --></span><span>
<!-- --></span><span></span><span class="token" style="color:#8be9fd">print<!-- --></span><span class="token" style="color:#f8f8f2">(<!-- --></span><span class="token" style="color:#f8f8f2">$decodedSecret<!-- --></span><span class="token" style="color:#f8f8f2">)<!-- --></span><span class="token" style="color:#f8f8f2">;<!-- --></span></code></pre></div><p>It then gave me the plain secret, which I inserted to the input and obtained the password for natas9.</p></section><section><h2>Reflection</h2><p>For reflection, I think it is simply a matter of encoding secrets. Encoding is not the most secure method of storing secrets. In this case, it was easily reversible. To increase the security, it is possible to encrypt using a secret password that is not shared. As such, unauthorised users such as myself will not be able to use the same steps to reverse the encoding as I would not have the secret key.</p><p>Another good method might be to use hashes especially for simple comparisons such as in this case. Result of hashes are mathematically irreversible and it is difficult to guess what values would map to the hash because of the avalanche effect of good hashes. But even with this, it is suggested to use obscure secrets, i.e. not common dictionary words as people have constructed tables of common words and what hash they map to.</p></section><section><h2>Key</h2><div class="SpoilerKey_codeBlock__KWl0d"><div class="SpoilerKey_spoilerToggler__HCeWZ"><button>Click to Reveal</button></div><div class="SpoilerKey_spoilerContainer__O76It"><div class="SpoilerKey_spoiler__YWx_s "><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto;border-radius:0.3em"><code style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>W0mMhUcRRnG8dcghE4qvk3JA9lGt8nDl<!-- --></span></code></pre></div></div></div></section><div class="PageNav_pageNav__NXqbT"><div><a title="Previous page" class="PageNav_navButton__yHhmO" href="natas/natas7">◀</a></div><div><a title="Next page" class="PageNav_navButton__yHhmO" href="natas/natas9">▶</a></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/natas/natas8","query":{},"buildId":"mae6w2jHhzZ9g4pmj3DgN","assetPrefix":"/over-the-wire","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>